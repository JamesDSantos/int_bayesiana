<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>5&nbsp; O modelo Bernoulli – Introdução à Inferência Bayesiana</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./teste.html" rel="next">
<link href="./estimacao.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./bernoulli.html"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">O modelo Bernoulli</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introdução à Inferência Bayesiana</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">summary.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introdução</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conjugada.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Famílias conjugadas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">O estimador de bayes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bernoulli.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">O modelo Bernoulli</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./teste.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Testes de hipóteses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">O modelo normal</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./negativeBinomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Binomial negativa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./aproximacaoNormal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Aproximação normal e seu uso com o Metropolis-Hastings</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./misturas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Misturas de distribuições</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">O modelo Poisson revisitado</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#o-modelo-univariado" id="toc-o-modelo-univariado" class="nav-link active" data-scroll-target="#o-modelo-univariado"><span class="header-section-number">5.1</span> O modelo univariado</a></li>
  <li><a href="#o-modelo-multivariado" id="toc-o-modelo-multivariado" class="nav-link" data-scroll-target="#o-modelo-multivariado"><span class="header-section-number">5.2</span> O modelo multivariado</a></li>
  <li><a href="#exercícios" id="toc-exercícios" class="nav-link" data-scroll-target="#exercícios"><span class="header-section-number">5.3</span> Exercícios</a>
  <ul class="collapse">
  <li><a href="#eficácia-de-um-novo-medicamento" id="toc-eficácia-de-um-novo-medicamento" class="nav-link" data-scroll-target="#eficácia-de-um-novo-medicamento"><span class="header-section-number">5.3.1</span> Eficácia de um Novo Medicamento</a></li>
  <li><a href="#preferência-por-uma-marca-de-café" id="toc-preferência-por-uma-marca-de-café" class="nav-link" data-scroll-target="#preferência-por-uma-marca-de-café"><span class="header-section-number">5.3.2</span> Preferência por uma Marca de Café</a></li>
  <li><a href="#taxa-de-aprovação-em-um-exame" id="toc-taxa-de-aprovação-em-um-exame" class="nav-link" data-scroll-target="#taxa-de-aprovação-em-um-exame"><span class="header-section-number">5.3.3</span> Taxa de Aprovação em um Exame</a></li>
  <li><a href="#eficácia-de-uma-campanha-de-vacinação" id="toc-eficácia-de-uma-campanha-de-vacinação" class="nav-link" data-scroll-target="#eficácia-de-uma-campanha-de-vacinação"><span class="header-section-number">5.3.4</span> Eficácia de uma Campanha de Vacinação</a></li>
  <li><a href="#a-eficácia-da-pfizer" id="toc-a-eficácia-da-pfizer" class="nav-link" data-scroll-target="#a-eficácia-da-pfizer"><span class="header-section-number">5.3.5</span> A eficácia da Pfizer</a></li>
  <li><a href="#o-naufrágio-do-lusitania-1915" id="toc-o-naufrágio-do-lusitania-1915" class="nav-link" data-scroll-target="#o-naufrágio-do-lusitania-1915"><span class="header-section-number">5.3.6</span> O Naufrágio do Lusitania (1915)</a></li>
  <li><a href="#imagem-corporal" id="toc-imagem-corporal" class="nav-link" data-scroll-target="#imagem-corporal"><span class="header-section-number">5.3.7</span> Imagem corporal</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">O modelo Bernoulli</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="o-modelo-univariado" class="level2" data-number="5.1">
<h2 data-number="5.1" class="anchored" data-anchor-id="o-modelo-univariado"><span class="header-section-number">5.1</span> O modelo univariado</h2>
<p>A distribuição <span class="math inline">\(F\)</span> é dita pertencer à família Bernoulli, com parâmetro <span class="math inline">\(\theta\in(0,1)\)</span> se sua função de probabilidade é dada por <span class="math display">\[f(x|\theta)=\theta^x(1-\theta)^{1-x},\]</span> com <span class="math inline">\(x\in\{0,1\}\)</span>. É imediato que <span class="math inline">\(\theta\)</span> representa a probabilidade de <span class="math inline">\(\{X=1\}\)</span>, sendo este evento conhecido como ‘sucesso’ em alguns textos (em contrapartida, <span class="math inline">\(\{X=0\}\)</span> é conhecido como `fracasso’).</p>
<p>Esta distribuição faz a importante conexão entre variáveis categóricas e aleatórias, tendo papel fundamental na inferência não paramétrica. Por exemplo, seja <span class="math inline">\(S\)</span> o sexo de um indivíduo selecionado ao acaso. Tal variável é categórica, podendo assumir os resultados <span class="math inline">\(A=\)</span>{feminino} ou <span class="math inline">\(A^c\)</span>. Contudo, pode-se definir a variável <span class="math inline">\(X=I(A)\)</span>, onde <span class="math inline">\(I(.)\)</span> é a função indicadora, definida por <span class="math display">\[I(A)=\left\{\begin{array}{ll} 1,&amp;\hbox{ se $A$ ocorre,} \\ 0,&amp;\hbox{ se $A^c$ ocorre.}\end{array}\right.
\]</span> Deste modo <span class="math inline">\(X\sim\hbox{Bernoulli}(\theta)\)</span>.</p>
<p>Como discutido anteriormente, o modelo Bernoulli(<span class="math inline">\(\theta\)</span>) pertence à família exponencial e sua distribuição conjugada é a Beta<span class="math inline">\((a,b)\)</span>. A distribuição a posteriori é dada por</p>
<p><span class="math display">\[f(\theta|\boldsymbol{x})\propto \theta^{a+\sum_{i=1}^n x_i-1}(1-\theta)^{n-\sum_{i=1}^n x_i+b-1},\]</span> ou seja, <span class="math inline">\(\theta|\boldsymbol{x}\sim\hbox{Beta}(a+\sum_{i=1}^n x_i,n-\sum_{i=1}^n x_i + b).\)</span> Observe que <span class="math inline">\(a\)</span> pode ser interpretado como o número de sucessos a priori e <span class="math inline">\(b\)</span> o número de fracassos. É comum utilizarmos a priori Beta<span class="math inline">\((1,1)\)</span>, que é equivalente à Uniforme(0,1), como priori pouco informativa.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.1</strong></span> Um estudo investiga a eficácia de uma nova campanha de vacinação contra a gripe em uma grande cidade. Antes da campanha, a taxa de vacinação na população adulta era de 40%. Após a campanha, uma amostra aleatória de 500 adultos revelou que 250 deles foram vacinados. Os pesquisadores querem determinar se a campanha aumentou significativamente a taxa de vacinação.</p>
<p>Seja <span class="math inline">\(\theta\)</span> a nova taxa de vacinação. Estamos interessados em testar a hipótese de que <span class="math inline">\(\theta&gt;0,4\)</span>. Considerando que o evento de interesse é um adulto vacinado, teremos que <span class="math inline">\(x_i=1\)</span> se o <span class="math inline">\(i\)</span>-ésimo adulto da amostra foi vacinado e <span class="math inline">\(x_i=0\)</span> em caso contrário. Utilizando a priori Beta(1,1), teremos <span class="math inline">\(\theta|x_1,\ldots,x_{500}\sim\hbox{Beta}(251,251)\)</span>. Deste modo a probabilidade a posteriori da hipótese é</p>
<p><span class="math display">\[P(\theta&gt;0,4|\boldsymbol{x})=\int_{0,4}^1 f(\theta|\boldsymbol{x})d\theta.\]</span> Utilizando o <code>R</code>, obtemos</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pbeta</span>(.<span class="dv">4</span>,<span class="dv">251</span>,<span class="dv">251</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.999997</code></pre>
</div>
</div>
<p>logo, a probabilidade de que a campanha aumentou a taxa de vacinação é maior que 99,999%.</p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.2</strong></span> <strong>As duas clínicas</strong></p>
<p>Em 1846, Ignaz Philipp Semmelweis se tornou assistente na Primeira Clínica de Obstetrícia do Hospital Geral de Viena, Áustria (algo como o residente chefe). Neste hospital o parto era oferecido de gratuitamente, pois o mesmo serveria de treinamento para os médicos e parteiras.</p>
<p>Naquela época, a febre puerperal era comum e muitas vezes fatal, sendo que a mortalidade variava entre 10% a 35%.</p>
<p>Haviam duas maternidades no Hospital Geral de Viena, conhecidas como a Primeira e a Segunda. A Primeira era considerada um local de morte e era evitada quando possível. Abaixo temos os dados registrados pelo Dr.&nbsp;Semmelweis</p>
<p><span class="math display">\[\begin{array}{c|cc|cc}\hline \hbox{} &amp; \hbox{Primeira} &amp; \hbox{Clínica} &amp; \hbox{Segunda} &amp; \hbox{Clínica}\\ \hline
\hbox{Ano} &amp; \hbox{Partos} &amp; \hbox{Mortes} &amp;\hbox{Partos} &amp; \hbox{Mortes} \\ \hline
1841 &amp; 3036 &amp; 237 &amp; 2442 &amp; 86 \\
1842 &amp; 3287 &amp; 518 &amp; 2659 &amp; 202 \\
1843 &amp; 3060 &amp; 274 &amp; 2739 &amp; 164 \\
1844 &amp; 3157 &amp; 260 &amp; 2956 &amp; 68 \\
1845 &amp; 3492 &amp; 241 &amp; 3241 &amp; 66 \\
1846 &amp; 4010 &amp; 459 &amp; 3754 &amp; 105 \\ \hline
\hbox{Total} &amp; 20.042 &amp; 1.989 &amp; 17.791 &amp; 691 \\ \hline
\end{array}\]</span></p>
<p>Pode-se considerar que cada parto gera duas possibilidades de eventos: a sobrivência ou a morte da mãe. Considere que, dentro da mesma clínica, esses eventos para cada mãe são indepentes e possuem a mesma probabilidade. Seja <span class="math inline">\(\alpha\)</span> a probabilidade de morte na Primeira Clínica e <span class="math inline">\(\beta\)</span> a mesma probabilidade para a Segunda Clínica. Então, as funções de verossimilhança para cada probabilidade são</p>
<p><span class="math display">\[\begin{align}L(\alpha)&amp;\propto \alpha^{1989} (1-\alpha)^{18053}\\L(\beta)&amp;\propto \beta^{691} (1-\beta)^{17100}\end{align}\]</span> Utilizando distribuição Uniforme(0,1) como priori para <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span>, teremos que</p>
<p><span class="math display">\[\begin{align}\alpha|\boldsymbol{x}&amp;\sim \hbox{Beta}(1990,18054) \\\beta|\boldsymbol{x}&amp;\sim \hbox{Beta}(692,17101)\end{align}\]</span></p>
<p>Abaixo, mostramos as duas posterioris, de onde podemos concluir que a probabilidade de morte na Primeira Clínica é certamente maior que na Segunda.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x,<span class="dv">1990</span>,<span class="dv">18054</span>),<span class="fl">0.03</span>,.<span class="dv">11</span>, <span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">ylab=</span><span class="st">'Densidades a posteriori'</span>,<span class="at">xlab=</span><span class="st">'Probabilidade de morte'</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">300</span>))</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x,<span class="dv">692</span>,<span class="dv">17101</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">add =</span> T)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(.<span class="dv">04</span>,.<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">290</span>,<span class="dv">210</span>),<span class="fu">c</span>(<span class="st">'Segunda Clínica'</span>,<span class="st">'Primeira Clínica'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="bernoulli_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>O Dr.&nbsp;Semmelweis ainda não tinha descoberto o motivo dessas mortes até a morte de seu amigo Jakob Kolletschka, que se cortou acidentalmente com um bisturi durante uma autópsia. Durante a autópsia de Jakob, o Dr.&nbsp;Semmelweis viu semelhanças com as autópsias as mulheres que havia morrido por febre puerperal.</p>
<p>Na Primeira Clínica estudavam os alunos de medicina, que realizavam autópsias. Na Segunda Clínica estudavam as parteiras, que não realizam autópsias. A sua hipótese foi: estudantes de medicina carregavam partículas cadavéricas que causavam a febre puerperal. Com essa hipótese, ele instituiu que todos os médicos deveriam lavar as mãos antes dos partos em maio de 1847. Abaixo, seguem os dados de Junho de 1848 até Março 1849, apenas para a Primeira Clínica</p>
<p><span class="math display">\[\begin{array}{c|cc} \hline \hbox{Período} &amp; \hbox{Partos} &amp; \hbox{Mortes}\\ \hline
\hbox{Jun/1847-Dez/1847} &amp; 1841 &amp; 56 \\
\hbox{Jan/1848-Dez/1848} &amp; 3556 &amp; 45 \\
\hbox{Jan/1849-Mar/1849} &amp; 1198 &amp; 41 \\ \hline
\hbox{Total} &amp; 6.595 &amp; 142 \\ \hline
\end{array}\]</span></p>
<p>Seja <span class="math inline">\(\gamma\)</span> a probabilidade de morte por febre puerperal na Primeira Clínica após a instrução de lavagem das mãos. Sua função de verossimilhança é</p>
<p><span class="math display">\[L(\gamma)\propto \gamma^{142}(1-\gamma)^{6453}.\]</span> Assumindo a priori Uniforme(0,1) para <span class="math inline">\(\gamma,\)</span> teremos que <span class="math inline">\(\gamma|\boldsymbol{x}\sim\hbox{Beta}(143,6454)\)</span>. Abaixo, apresentamos o gráfico das três densidades a posteriori obtidas, mostrando que <span class="math inline">\(\gamma\)</span> é certamente menor que as outras probabilidades.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x,<span class="dv">1990</span>,<span class="dv">18054</span>),<span class="dv">0</span>,.<span class="dv">11</span>, <span class="at">lwd =</span> <span class="dv">2</span>,<span class="at">ylab=</span><span class="st">'Densidades a posteriori'</span>,<span class="at">xlab=</span><span class="st">'Probabilidade de morte'</span>,<span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">300</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x,<span class="dv">692</span>,<span class="dv">17101</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">add =</span> T)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x,<span class="dv">143</span>,<span class="dv">6454</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">add =</span> T)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(.<span class="dv">01</span>,.<span class="dv">04</span>,.<span class="dv">1</span>),<span class="fu">c</span>(<span class="dv">250</span>,<span class="dv">290</span>,<span class="dv">212</span>),<span class="fu">c</span>(<span class="st">'Primeira Clínica </span><span class="sc">\n</span><span class="st">(1847-1849)'</span>,<span class="st">'Segunda Clínica'</span>,<span class="st">'Primeira Clínica</span><span class="sc">\n</span><span class="st">(1841-1846)'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="bernoulli_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Após a publicação de seus achados, as ideia do Dr.&nbsp;Semmelweis foram amplamente rejeitadas por seus colegas médicos, que se sentiram ofendidos com a sugestão de que poderiam estar causando a morte de seus pacientes. A rejeição e o ridículo que Semmelweis enfrentou levaram a um declínio em sua saúde mental. Ele foi internado no hospício em 1865, onde morreu pouco tempo depois. Morreu em 13 de agosto de 1865, em um hospício em Viena, aos 47 anos. A causa exata de sua morte ainda é debatida, mas a teoria mais aceita é que ele morreu de septicemia, uma infecção sanguínea, após ser espancado pelos guardas do hospício. <span class="math display">\[\blacksquare\]</span></p>
</div>
<p>No exemplo anterior foi possível verificar graficamente que as probabilidades de morte por febre puerperal em ambas as clínicas eram distintas. Recordando que as respectivas probabilidades foram identificadas por <span class="math inline">\(\alpha\)</span> e <span class="math inline">\(\beta\)</span>, era evidente que <span class="math inline">\(P(\alpha&gt;\beta|\hbox{dados})=1\)</span>.</p>
<p>Quando a evidência gráfica não é clara, é necessário calcular tal probabilidade. Sejam <span class="math inline">\(X_1,\ldots,X_n\)</span> e <span class="math inline">\(Y_1,\ldots,Y_m\)</span> duas amostras aleatórias independentes com <span class="math inline">\(X_i|\alpha\sim\hbox{Bernoulli}(\alpha)\)</span> e <span class="math inline">\(Y_i|\beta\sim\hbox{Bernoulli}(\beta)\)</span>. Considerando prioris conjugadas, teremos que <span class="math inline">\(\alpha|\boldsymbol{x}\)</span> e <span class="math inline">\(\beta|\boldsymbol{y}\)</span> possuem distribuição beta e são independentes. Para testar uma hipótese do tipo <span class="math inline">\(H: \alpha&gt;\beta\)</span> é necessário calcular</p>
<p><span class="math display">\[p=P(\alpha&gt;\beta|\boldsymbol{x},\boldsymbol{y}).\]</span> Contudo, podemos definir a variável <span class="math inline">\(A=\left\{\begin{array}{ll}1,&amp;\alpha&gt;\beta\\ 0,&amp;\alpha\leq \beta\end{array}\right.\)</span> Deste modo, <span class="math inline">\(A\sim\hbox{Bernoulli}(p)\)</span>. Acontece que <span class="math inline">\(p=E(A)\)</span> e, pela Lei Forte dos Grandes Números, para a sequência <span class="math inline">\(A_1,A_2,\ldots,\)</span> teremos que <span class="math display">\[\frac{1}{B}\sum_{j=1}^B A_j\rightarrow E(A)=p,\;\; B\rightarrow\infty\]</span> Deste modo, se tivermos uma observação da amostra aleatória <span class="math inline">\(A_1,\ldots,A_B\)</span> é possível calcular <span class="math inline">\(p\)</span> com boa precisão para <span class="math inline">\(B\)</span> suficientemente grande. Podemos obter essa amostra via simulação. Esse é o princípio do Método de Monte Carlo.</p>
<div class="alert alert-success">
<p><strong>Método de Monte Carlo</strong> Considere o problema de calcular <span class="math display">\[p=E(X).\]</span> * Passo 1. Simule <span class="math inline">\(x_1,\ldots,x_B\)</span> com <span class="math inline">\(B\)</span> suficientemente grande</p>
<ul>
<li>Passo 2. Estime <span class="math inline">\(p\)</span> através de</li>
</ul>
<p><span class="math display">\[\frac{1}{B}\sum_{j=1}^B x_j\]</span></p>
</div>
<p>Para calcular <span class="math inline">\(p=P(\alpha&gt;\beta|\hbox{dados})\)</span> apresentado anteriormente, podemos realizar os seguintes passos:</p>
<ul>
<li><p>Passo 1. Escolha <span class="math inline">\(B\)</span> suficientemente grande</p></li>
<li><p>Passo 2. Simule <span class="math inline">\(\alpha_1,\ldots,\alpha_B\)</span> a posteriori <span class="math inline">\(\alpha|\hbox{x}\)</span></p></li>
<li><p>Passo 3. Simule <span class="math inline">\(\beta_1,\ldots,\beta_B\)</span> a posteriori <span class="math inline">\(\beta|\hbox{y}\)</span></p></li>
<li><p>Passo 4. Calcule</p></li>
</ul>
<p><span class="math display">\[\frac{1}{B}\sum_{j=1}^B I(\alpha_j&gt;\beta_j)\]</span></p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.3</strong></span> <strong>Naufrágio do Lusitania (1915)</strong></p>
<p>Em 7 de maio de 1915, durante a Primeira Guerra Mundial, o RMS Lusitania, um luxuoso transatlântico britânico, navegava a cerca de 18 km da costa sul da Irlanda. A bordo, passageiros de diversas nacionalidades, incluindo muitos americanos, desfrutavam de uma viagem que deveria levá-los de Nova York a Liverpool. No entanto, o que era para ser uma travessia rotineira transformou-se em tragédia quando o navio foi torpedeado pelo submarino alemão U-20.</p>
<p>Atingido no lado estibordo, o Lusitania sofreu uma segunda explosão interna, cuja causa ainda é debatida, e afundou em apenas 18 minutos. A rapidez com que o navio submergiu, aliada à dificuldade de lançar os botes salva-vidas, resultou na morte de 1.198 pessoas, entre passageiros e tripulantes. O naufrágio do Lusitania gerou indignação internacional e intensificou a pressão para que os Estados Unidos entrassem na guerra, o que ocorreu dois anos depois.</p>
<p>O número de passageiros que morreram e sobreviveram em cada classe é dado abaixo.</p>
<p><span class="math display">\[\begin{array}{l|cc} \hline
\hbox{Classe} &amp; \hbox{Sobreviventes} &amp; \hbox{Mortos} \\ \hline
\hbox{Primeira} &amp; 113 &amp; 177 \\
\hbox{Segunda} &amp; 229 &amp; 372 \\
\hbox{Terceira}  &amp; 134 &amp; 239 \\ \hline
\end{array}\]</span></p>
<p>Neste exemplo, vamos testar a hipótese de que tripulantes da Classe 1 tinham maior probabilidade de sobrevivência que os dados classes inferiores. Seja <span class="math inline">\(\alpha,\beta,\gamma\)</span> as probabilidades de sobrevivência das classes 1, 2 e 3, respectivamente, Considerando uma priori Beta(1,1) para cada classe, teremos que a posteriori para a probabilidade de sobrevivência é dada por</p>
<ul>
<li><span class="math inline">\(\alpha\sim\)</span>Beta(114,178) para a classe 1</li>
<li><span class="math inline">\(\beta\sim\)</span>Beta(230,373) para a classe 2</li>
<li><span class="math inline">\(\gamma\sim\)</span>Beta(135,240) para a classe 3</li>
</ul>
<p>O gráfico das posterioris é dado abaixo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x, <span class="dv">114</span>,<span class="dv">178</span>), <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">20</span>), <span class="at">ylab =</span> <span class="st">'Densidades das posterioris'</span>, <span class="at">xlab =</span> <span class="st">'Probabilidade de sobrevivência'</span>, <span class="at">xlim=</span><span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">6</span>))</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x, <span class="dv">230</span>,<span class="dv">373</span>), <span class="at">add =</span> T, <span class="at">col =</span><span class="dv">2</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x, <span class="dv">135</span>,<span class="dv">240</span>), <span class="at">add =</span> T ,<span class="at">col =</span><span class="dv">3</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'topright'</span>,<span class="fu">c</span>(<span class="st">'Classe 1'</span>,<span class="st">'Classe 2'</span>,<span class="st">'Classe 3'</span>), <span class="at">lwd =</span><span class="dv">2</span>, <span class="at">col=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">bty=</span><span class="st">'n'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="bernoulli_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Vamos simular uma amostra de tamanho <span class="math inline">\(B=1000000\)</span> das posterioris de <span class="math inline">\(\alpha,\beta,\gamma\)</span>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000000</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>alfa <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(B, <span class="dv">114</span>,<span class="dv">178</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>beta  <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(B, <span class="dv">230</span>,<span class="dv">373</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>gama  <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(B, <span class="dv">135</span>,<span class="dv">240</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Vamos testar a hipótese de que a probabilidade de sobrevivência de um indivíduo da Classe 1 foi maior que a de um indivíduo da Classe 2 e 3.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(alfa<span class="sc">&gt;</span>beta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.599994</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(alfa<span class="sc">&gt;</span>gama)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.788499</code></pre>
</div>
</div>
<p>Observe que <span class="math inline">\(P(\alpha&gt;\gamma|\hbox{dados})\approx 0,78\)</span>, o que não dá suporte para afirmar que a probabilidade de sobrevivência dos tripulantes da primeira classe foi maior do que o da terceira. <span class="math display">\[\blacksquare\]</span></p>
</div>
</section>
<section id="o-modelo-multivariado" class="level2" data-number="5.2">
<h2 data-number="5.2" class="anchored" data-anchor-id="o-modelo-multivariado"><span class="header-section-number">5.2</span> O modelo multivariado</h2>
<p>A distribuição Bernoulli pode ser generalizada para o caso multivariado: considere um evento aleatório com possibilidades <span class="math inline">\(A_1,\ldots,A_k\)</span>. Seja <span class="math inline">\(X_j=I(A_j)\)</span> e seja <span class="math inline">\(\theta_j\)</span> a probabilidade do evento resultar em <span class="math inline">\(A_j\)</span>. Então, o vetor <span class="math inline">\(\boldsymbol{X}=(X_1,\ldots,X_k)\)</span> tem distribuição Bernoulli multivariada, cuja função de probabilidade é dada por <span class="math display">\[f(\boldsymbol{x}|\boldsymbol{\theta})=\prod_{j=1}^k\theta_j^{x_{j}},\]</span> onde <span class="math inline">\(x_j\in\{0,1\}\)</span>, <span class="math inline">\(\sum_{j=1}^kx_j=1\)</span>, <span class="math inline">\(\theta_j\in(0,1)\)</span> e <span class="math inline">\(\sum_{j=1}^k\theta_j=1\)</span>. É importante notar que vetor <span class="math inline">\(\boldsymbol{\theta}\)</span> tem apenas <span class="math inline">\(k-1\)</span> parâmetros de fato, uma vez que <span class="math inline">\(\theta_k=1-\sum_{j=1}^{k-1}\theta_j\)</span>. Conjuntos do tipo <span class="math display">\[\mathcal{S}^k=\left\{(\theta_1,\ldots,\theta_{k-1}):0&lt;\theta_j&lt;1,0&lt;\sum_{j=1}^{k-1}\theta_j&lt;1\right\}\]</span> são denominados simplex.</p>
<p>Seja <span class="math inline">\(\boldsymbol{x}_1,\ldots,\boldsymbol{x}_n\)</span> uma amostra de vetores Bernoulli Multivariada(<span class="math inline">\(\theta_1,\ldots,\theta_k\)</span>), onde <span class="math inline">\(\boldsymbol{x}_i=\{x_{i,1},\ldots,x_{i,k}\}\)</span>. Então,</p>
<p><span class="math display">\[\begin{align}L(\boldsymbol{\theta})&amp;=\prod_{i=1}^nf(\boldsymbol{x}_i|\boldsymbol{\theta})=\prod_{i=1}^n\left(\prod_{j=1}^k \theta_j^{x_{i,j}}\right)=\prod_{j=1}^k \prod_{i=1}^n\theta_j^{x_{i,j}}\\&amp;=\prod_{j=1}^k \theta_j^{\sum_{i=1}^nx_{i,j}}=\prod_{j=1}^n\theta_j^{n_j}\end{align}\]</span> onde <span class="math inline">\(n_j\)</span> é o número de vezes que ocorreu a categoria <span class="math inline">\(A_j\)</span>. É imediado que</p>
<p><span class="math display">\[L(\boldsymbol{\theta})=\exp\left\{\sum_{j=1}^k n_j\log(\theta_j)\right\},\]</span> o que implica que este modelo pertence à família exponencial. Seu modelo conjugado é a Dirichlet(<span class="math inline">\(a_1,\ldots,a_k\)</span>), cuja função densidade é <span class="math display">\[f(\theta_1,\ldots,\theta_k)=\frac{\Gamma\left(\sum_{j=1}^k a_j\right)}{\prod_{j=1}^k \Gamma(a_j)}\prod_{j=1}^k \theta^{a_j-1},\]</span> onde <span class="math inline">\((\theta_1,\ldots,\theta_{k-1})\)</span> pertence ao simplex <span class="math inline">\(\mathcal{S}^k\)</span>.</p>
<p>A Dirichlet<span class="math inline">\((a_1,\ldots,a_k)\)</span> possui as seguintes propriedades:</p>
<ul>
<li><span class="math inline">\(\theta_j\sim\hbox{Beta}(a_j,\sum_{i\neq j}a_i)\)</span></li>
<li><span class="math inline">\((\theta_1,\ldots,\theta_i+\theta_j,\ldots,\theta_k)\sim\hbox{Dirichlet}(a_1,\ldots,a_i+a_j,\ldots,a_k)\)</span></li>
</ul>
<p>Da primeira propriedade, concluímos que <span class="math display">\[E(\theta_j)=\frac{a_j}{\sum_{i=1}^k a_i},\;\;Var(\theta_j)=\frac{E(\theta_j)(1-E(\theta_j))}{\sum_{i=1}^k a_i+1}.\]</span></p>
<p>Utilizando o modelo conjugado, a distribuição a posteriori de <span class="math inline">\(\theta_1,\ldots,\theta_k\)</span> é</p>
<p><span class="math display">\[f(\boldsymbol{\theta}|\boldsymbol{x})\propto \prod_{i=j}^k \theta_j^{n_j+a_j-1}\]</span> ou seja, <span class="math inline">\(\boldsymbol{\theta}|\boldsymbol{x}\sim\hbox{Dirichlet}(n_1+a_1,\ldots,n_k+a_k)\)</span>. Novamente, pode-se utilizar <span class="math inline">\(a_1=\cdots=a_k=1\)</span> para obter uma priori pouco informativa.</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 5.4</strong></span> <strong>Imagem corporal</strong></p>
<p>O projeto Estado nutricional e sua relação com a imagem corporal em escolares do município de Manaus foi submetido ao LabEst em 2013. Nele, estudantes identificavam como gostaria que fosse o seu corpo segundo a Escala de Stunkard, apresentada na imagem abaixo. Em seguida, uma série de medidas foram realizadas para determinar a real classificação do estudante. Com base nessas informações, cada estudante foi classificado segundo sua satisfação com o próprio corpo do seguinte modo:</p>
<ul>
<li><p>Satisfeito: seu desejo é equivalente ao seu estado atual.</p></li>
<li><p>Insatisfeito por excesso: o estudante gostaria ter medidas menores.</p></li>
<li><p>Insatisfeito por magreza: o estudante gostaria ter medidas maiores.</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="percepcao-da-imagem-corporal-do-estudante-01.jpg" class="img-fluid figure-img"></p>
<figcaption>Escala de Stunkard</figcaption>
</figure>
</div>
<p>Neste exemplo, vamos analisar o recorte dos resultados para alunos entre 16 e 17 anos, diferenciando entre os sexos. As frequências estão sumariadas na tabela abaixo.</p>
<p><span class="math display">\[\begin{array}{c|ccc|c}\hline
&amp;\hbox{Satisfeito} &amp; \hbox{Insatifeito por excesso} &amp; \hbox{Insatisfeito por magreza} &amp;\hbox{Total}\\ \hline
\hbox{Masculino} &amp; 24 &amp; 10 &amp; 24 &amp; 58 \\
\hbox{Feminino} &amp; 14 &amp; 22 &amp; 24 &amp; 60 \\ \hline
\end{array}
\]</span> Cada estudante pode assumir uma das três classificações. Sejam <span class="math inline">\(\alpha_S,\alpha_E,\alpha_M\)</span> as probabilidades de alguém do sexo masculino estar classificado como Satisfeito, Insatisfeito por Excesso ou Insatisfeito por magreza, respectivamente. Então a função de verossimilhança para <span class="math inline">\(\boldsymbol{\alpha}\)</span> é</p>
<p><span class="math display">\[L(\boldsymbol{\alpha})=\alpha_S^{24}\alpha_E^{10}\alpha_M^{24}.\]</span> Analogamente, fazendo <span class="math inline">\(\boldsymbol{\beta}=(\beta_S,\beta_E,\beta_M)\)</span>, as mesmas probabilidades para o sexo feminino, teremos que</p>
<p><span class="math display">\[L(\boldsymbol{\alpha})=\beta_S^{14}\beta_E^{22}\beta_M^{24}.\]</span></p>
<p>Utilizando a priori Dirichlet(1,1,1) tanto para <span class="math inline">\(\boldsymbol{\alpha}\)</span> quanto para <span class="math inline">\(\boldsymbol{\beta}\)</span>, teremos que as respectivas posterioris para <span class="math inline">\(\boldsymbol{\alpha}\)</span> e <span class="math inline">\(\boldsymbol{\beta}\)</span> são Dirichelt(25,11,25) e Dirichlet(15,23,25).</p>
<p>As posterioris para <span class="math inline">\(\alpha_M\)</span> e <span class="math inline">\(\beta_M\)</span> e são Beta(25,36) Beta(25,38). As estimativas pontuais são 0,40 e 0,39, respectivamente. A imagem abaixo mostra a insatisfação por magreza entre os sexos deve ser a mesma.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x,<span class="dv">25</span>,<span class="dv">36</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">xlab =</span> <span class="st">'Probabilidade de insatisfação por magreza'</span>, <span class="at">ylab=</span> <span class="st">'Densidades marginais a posteriori'</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">8</span>),<span class="at">xlim=</span><span class="fu">c</span>(.<span class="dv">1</span>,.<span class="dv">8</span>),<span class="at">col=</span><span class="st">'blue'</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x,<span class="dv">25</span>,<span class="dv">38</span>),<span class="at">add =</span> T, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">'red'</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(.<span class="dv">6</span>,.<span class="dv">2</span>),<span class="fu">c</span>(<span class="dv">6</span>,<span class="dv">6</span>), <span class="fu">c</span>(<span class="st">'Masculino'</span>,<span class="st">'Feminino'</span>),<span class="at">col=</span><span class="fu">c</span>(<span class="st">'blue'</span>,<span class="st">'red'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="bernoulli_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>As posterioris para <span class="math inline">\(\alpha_E\)</span> e <span class="math inline">\(\beta_E\)</span> são Beta(11,50)e Beta(23,40). As estimativas pontuais são 0,21 e 0,36, respectivamente. A imagem abaixo mostra que as mulheres em geral parecem possuir maior probabilidade de insatisfação por excesso.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x,<span class="dv">11</span>,<span class="dv">50</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">xlab =</span> <span class="st">'Probabilidade de insatisfação por excesso'</span>, <span class="at">ylab=</span> <span class="st">'Densidades marginais a posteriori'</span>, <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">10</span>),<span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>,.<span class="dv">6</span>))</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dbeta</span>(x,<span class="dv">23</span>,<span class="dv">40</span>),<span class="at">add =</span> T, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="fu">c</span>(.<span class="dv">2</span>,.<span class="dv">4</span>),<span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">7</span>), <span class="fu">c</span>(<span class="st">'Masculino'</span>,<span class="st">'Feminino'</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="bernoulli_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Podemos então construir a hipótese <span class="math inline">\(H:\alpha_E&lt;\beta_E\)</span>. Abaixo, testamos essa hipótese:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">1000000</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>alfaE <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(B, <span class="dv">11</span>,<span class="dv">50</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>betaE <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(B, <span class="dv">23</span>,<span class="dv">40</span>)</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(alfaE<span class="sc">&lt;</span>betaE)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.990628</code></pre>
</div>
</div>
<p>Com uma probabilidade maior que 99%, há fortes evidências de que mulheres entre 16 e 17 anos se sentem mais insatisfeitas por excesso do que os homens de mesma idade.</p>
</div>
</section>
<section id="exercícios" class="level2" data-number="5.3">
<h2 data-number="5.3" class="anchored" data-anchor-id="exercícios"><span class="header-section-number">5.3</span> Exercícios</h2>
<section id="eficácia-de-um-novo-medicamento" class="level3" data-number="5.3.1">
<h3 data-number="5.3.1" class="anchored" data-anchor-id="eficácia-de-um-novo-medicamento"><span class="header-section-number">5.3.1</span> Eficácia de um Novo Medicamento</h3>
<p>Uma empresa farmacêutica desenvolveu um novo medicamento para tratar enxaquecas. Antes do lançamento, eles afirmam que o medicamento alivia a dor em pelo menos 80% dos pacientes. Um estudo independente com 250 pacientes revelou que 180 deles relataram alívio da dor. Os resultados do estudo fornecem evidências suficientes para rejeitar a alegação da empresa farmacêutica?</p>
</section>
<section id="preferência-por-uma-marca-de-café" class="level3" data-number="5.3.2">
<h3 data-number="5.3.2" class="anchored" data-anchor-id="preferência-por-uma-marca-de-café"><span class="header-section-number">5.3.2</span> Preferência por uma Marca de Café</h3>
<p>Uma pesquisa de mercado afirma que 55% dos consumidores preferem a marca A de café à marca B. Uma amostra aleatória de 300 consumidores revelou que 180 deles preferem a marca A. Os resultados da amostra fornecem evidências suficientes para rejeitar a alegação da pesquisa de mercado?</p>
</section>
<section id="taxa-de-aprovação-em-um-exame" class="level3" data-number="5.3.3">
<h3 data-number="5.3.3" class="anchored" data-anchor-id="taxa-de-aprovação-em-um-exame"><span class="header-section-number">5.3.3</span> Taxa de Aprovação em um Exame</h3>
<p>Uma escola afirma que a taxa de aprovação em um exame padronizado é de 70%. Uma amostra de 200 alunos revelou que 120 deles foram aprovados. Os resultados da amostra fornecem evidências suficientes para rejeitar a alegação da escola?</p>
</section>
<section id="eficácia-de-uma-campanha-de-vacinação" class="level3" data-number="5.3.4">
<h3 data-number="5.3.4" class="anchored" data-anchor-id="eficácia-de-uma-campanha-de-vacinação"><span class="header-section-number">5.3.4</span> Eficácia de uma Campanha de Vacinação</h3>
<p>Uma campanha de vacinação contra a gripe foi realizada em uma cidade. Antes da campanha, a taxa de vacinação era de 35%. Após a campanha, uma amostra de 400 pessoas revelou que 180 delas foram vacinadas. Os resultados da amostra fornecem evidências suficientes para concluir que a campanha aumentou a taxa de vacinação?</p>
</section>
<section id="a-eficácia-da-pfizer" class="level3" data-number="5.3.5">
<h3 data-number="5.3.5" class="anchored" data-anchor-id="a-eficácia-da-pfizer"><span class="header-section-number">5.3.5</span> A eficácia da Pfizer</h3>
<p>O artigo <span class="citation" data-cites="polack2020safety">Polack et al. (<a href="#ref-polack2020safety" role="doc-biblioref">2020</a>)</span> apresenta um estudo clínico de fase 3 randomizado e controlado por placebo que avaliou a eficácia da vacina BNT162b2 (Pfizer-BioNTech COVID-19) em participantes com 16 anos ou mais sem evidências de infecção por SARS-CoV-2. A tabela abaixo apresenta o número de participantes por grupo e o número de casos de Covid-19.</p>
<p><span class="math display">\[\begin{array}{l|cc}\hline
\hbox{Grupo} &amp; \hbox{Participantes} &amp; \hbox{Casos de Covid-19}\\\hline
\hbox{Vacina} &amp; 18.198 &amp; 8 \\
\hbox{Placebo} &amp; 18.325 &amp; 162 \\ \hline
\end{array}\]</span></p>
<p>Considere que o evento de interesse é contrair Covid-19</p>
<ul>
<li><p>Encontre a função de verossimilhança para cada grupo</p></li>
<li><p>Utilizando a priori Beta(1,1) para a probabilidade de contrair Covid-19, encontre a distribuição a posteriori para cada grupo</p></li>
<li><p>Faça um gráfico das posterioris e verifique se há evidências de que a vacinação é eficaz.</p></li>
</ul>
</section>
<section id="o-naufrágio-do-lusitania-1915" class="level3" data-number="5.3.6">
<h3 data-number="5.3.6" class="anchored" data-anchor-id="o-naufrágio-do-lusitania-1915"><span class="header-section-number">5.3.6</span> O Naufrágio do Lusitania (1915)</h3>
<p>Neste capítulo, abordamos a tragédia do Lusitania. A tabela abaixo acrescenta os dados sobre a tripulação.</p>
<p><span class="math display">\[\begin{array}{l|cc} \hline
\hbox{Categoria} &amp; \hbox{Sobreviventes} &amp; \hbox{Mortos} \\ \hline
\hbox{Primeira classe} &amp; 113 &amp; 177 \\
\hbox{Segunda classe} &amp; 229 &amp; 372 \\
\hbox{Terceira classe}  &amp; 134 &amp; 239 \\ \hline
\hbox{Tripulação - abastecimento} &amp; 139 &amp; 167 \\
\hbox{Tripulação - engenharia} &amp; 112 &amp; 201 \\
\hbox{Tripulação - deck} &amp; 41 &amp; 37 \\
\hline
\end{array}\]</span></p>
<p>Compare a probabilidade de sobrevivência entre os indivíduos dos diferentes tipos de tripulação e classes de passageiros, testando as hipóteses necessárias.</p>
</section>
<section id="imagem-corporal" class="level3" data-number="5.3.7">
<h3 data-number="5.3.7" class="anchored" data-anchor-id="imagem-corporal"><span class="header-section-number">5.3.7</span> Imagem corporal</h3>
<p>Neste capítulo, mostramos que homens e mulheres com idades entre 16 e 17 anos possuem expectativas diferentes em relação ao seu próprio corpo.</p>
<p>Neste exercício, você vai verificar como essas expectativas variam dentro do mesmo sexo. Especificamente:</p>
<ul>
<li><p>Teste se há evidências de que os homens possuem probabilidade maior de estarem insatisfeitos por magreza do que satisfeitos.</p></li>
<li><p>Teste se há evidências de que as mulheres possuem probabilidade maior de estarem insatisfeitas por excesso do que satisfeitas.</p></li>
</ul>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-polack2020safety" class="csl-entry" role="listitem">
Polack, Fernando P, Stephen J Thomas, Nicholas Kitchin, Judith Absalon, Alejandra Gurtman, Stephen Lockhart, John L Perez, et al. 2020. <span>“Safety and Efficacy of the BNT162b2 mRNA Covid-19 Vaccine.”</span> <em>New England Journal of Medicine</em> 383 (27): 2603–15.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./estimacao.html" class="pagination-link" aria-label="O estimador de bayes">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">O estimador de bayes</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./teste.html" class="pagination-link" aria-label="Testes de hipóteses">
        <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Testes de hipóteses</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>