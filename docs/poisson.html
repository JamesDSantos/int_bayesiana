<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; O modelo Poisson – Introdução à Inferência Bayesiana</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./normal.html" rel="next">
<link href="./teste.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./poisson.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">O modelo Poisson</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introdução à Inferência Bayesiana</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">summary.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introdução</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conjugada.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Famílias conjugadas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">O estimador de bayes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bernoulli.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">O modelo Bernoulli</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./teste.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Testes de hipóteses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./poisson.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">O modelo Poisson</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">O modelo normal</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./negativeBinomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Binomial negativa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./aproximacaoNormal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Aproximação normal e seu uso com o Metropolis-Hastings</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./misturas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Misturas de distribuições</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">O modelo Poisson</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sobre-o-modelo" id="toc-sobre-o-modelo" class="nav-link active" data-scroll-target="#sobre-o-modelo"><span class="header-section-number">7.1</span> Sobre o modelo</a>
  <ul class="collapse">
  <li><a href="#tempo-de-chegada-e-de-espera" id="toc-tempo-de-chegada-e-de-espera" class="nav-link" data-scroll-target="#tempo-de-chegada-e-de-espera"><span class="header-section-number">7.1.1</span> Tempo de chegada e de espera</a></li>
  <li><a href="#ocorrências-de-diversas-classes" id="toc-ocorrências-de-diversas-classes" class="nav-link" data-scroll-target="#ocorrências-de-diversas-classes"><span class="header-section-number">7.1.2</span> Ocorrências de diversas classes</a></li>
  <li><a href="#o-processo-de-poisson-espacial" id="toc-o-processo-de-poisson-espacial" class="nav-link" data-scroll-target="#o-processo-de-poisson-espacial"><span class="header-section-number">7.1.3</span> O processo de Poisson Espacial</a></li>
  </ul></li>
  <li><a href="#verossimilhança-e-priori-conjugada" id="toc-verossimilhança-e-priori-conjugada" class="nav-link" data-scroll-target="#verossimilhança-e-priori-conjugada"><span class="header-section-number">7.2</span> Verossimilhança e priori conjugada</a></li>
  <li><a href="#preditiva-a-posteriori" id="toc-preditiva-a-posteriori" class="nav-link" data-scroll-target="#preditiva-a-posteriori"><span class="header-section-number">7.3</span> Preditiva a posteriori</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">O modelo Poisson</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="sobre-o-modelo" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="sobre-o-modelo"><span class="header-section-number">7.1</span> Sobre o modelo</h2>
<p>Seja <span class="math inline">\(N(t)\)</span> o número de ocorrências observadas no intervalo de tempo <span class="math inline">\([0,t]\)</span> (considere que <span class="math inline">\(N(0)=0\)</span>). Note que o número de eventos no intervalo <span class="math inline">\((s,t]\)</span> é dado por <span class="math inline">\(N(t)-N(s)\)</span>.</p>
<p>Dizemos que <span class="math inline">\(N(t)\)</span> tem incrementos independentes se, para quaisquer intervalos disjuntos <span class="math inline">\((s_0,t_0]\)</span> e <span class="math inline">\((s_1,t_1]\)</span>, as contagens <span class="math inline">\(N(t_0)-N(s_0)\)</span> e <span class="math inline">\(N(t_1)-N(s_1)\)</span> são independentes.</p>
<p><span class="math inline">\(N(t)\)</span> é denominado Processo de Poisson quando ele possui incrementos indepentes e, para qualquer intervalo <span class="math inline">\((s,t]\)</span>,</p>
<p><span class="math display">\[P(N(t)-N(s)=x)=\frac{e^{-\lambda(t-s)[\lambda(t-s)]^x}}{x!},\]</span> onde <span class="math inline">\(x=0,1,\ldots\)</span> e <span class="math inline">\(\lambda&gt;0\)</span>. Isto implica que <span class="math display">\[E(N(t))=\lambda t,\]</span> ou seja, o número esperado de ocorrências até o tempo <span class="math inline">\(t\)</span> é diretamente proporcional à <span class="math inline">\(t\)</span> e <span class="math inline">\(\lambda\)</span> representa a taxa de crescimento. Para este processo, é verdade que <span class="math display">\[\lim_{\delta\rightarrow 0}P(N(t+\delta)-N(t)&gt;1)=0,\]</span> ou seja, não é possível observar duas ou mais ocorrências simultaneamente.</p>
<p>Em geral, os experimentos são desenhados para registrar contagens em intervalos regulares e disjuntos de tempo, como semanas ou anos. Considere que tais intervalos são <span class="math inline">\([0,s_1],(s_1,s_2],\ldots,(s_{n-1},t]\)</span> e seja <span class="math inline">\(c\)</span> o comprimento destes intervalos. Em geral, os dados são apresentados como contagens dentro destes intevalos, gerando as seguintes variáveis:</p>
<ul>
<li><span class="math inline">\(X_1=N(s_1)\sim\hbox{Poisson}(\lambda c)\)</span></li>
<li><span class="math inline">\(X_2=N(s_2)-N(s_1)\sim\hbox{Poisson}(\lambda c)\)</span></li>
<li><span class="math inline">\(\cdots\)</span></li>
<li><span class="math inline">\(X_n=N(t)-N(s_{n-1})\sim\hbox{Poisson}(\lambda c)\)</span> ou seja, <span class="math inline">\(X_1,\ldots,X_n\)</span> são uma amostra aleatória do modelo Poisson(<span class="math inline">\(\lambda c\)</span>). Na prática, <span class="math inline">\(c=1\)</span> por ser a unidade de medida de tempo associada ao experimento (uma semana, um ano, etc).</li>
</ul>
<section id="tempo-de-chegada-e-de-espera" class="level3" data-number="7.1.1">
<h3 data-number="7.1.1" class="anchored" data-anchor-id="tempo-de-chegada-e-de-espera"><span class="header-section-number">7.1.1</span> Tempo de chegada e de espera</h3>
<p>Para um processo de Poisson <span class="math inline">\(N(t)\)</span>, definimos o tempo de chegada como o tempo entre duas observações consecutivas. Denotaremos o tempo de chegadas entre a <span class="math inline">\(i\)</span>-ésima e a <span class="math inline">\((i-1)\)</span>- ésima ocorrência por <span class="math inline">\(T_i\)</span>.</p>
<p>É possível mostrar que <span class="math inline">\(T_i\)</span> é independente de <span class="math inline">\(T_j\)</span>, para <span class="math inline">\(i\neq j\)</span> e que <span class="math inline">\(T_i\sim\hbox{Exponencial}(\lambda)\)</span>. Por isso, para uma amostra aleatória de um modelo Exponencial(<span class="math inline">\(\lambda\)</span>), o parâmetro <span class="math inline">\(\lambda\)</span> é denominado taxa.</p>
<p>Definimos por tempo de espera da ocorrência <span class="math inline">\(n\)</span> como o tempo transcorrido desde o início do processo até a ocorrência do <span class="math inline">\(n\)</span>-ésimo evento. Este tempo de espera é denotado por <span class="math inline">\(S_n\)</span>. Exsitem dois resultados importantes relacionados ao tempo de espera:</p>
<ul>
<li><p><span class="math inline">\(S_n=T_1+\cdots+T_n\)</span> tem distribuição Gama(<span class="math inline">\(n,\lambda\)</span>)</p></li>
<li><p>Dado que <span class="math inline">\(N(t)=n\)</span>, os tempos de espera dos eventos estão uniformemente distribuídos dentro do intervalo <span class="math inline">\((0,t)\)</span>.</p></li>
</ul>
</section>
<section id="ocorrências-de-diversas-classes" class="level3" data-number="7.1.2">
<h3 data-number="7.1.2" class="anchored" data-anchor-id="ocorrências-de-diversas-classes"><span class="header-section-number">7.1.2</span> Ocorrências de diversas classes</h3>
<p>Suponha que as ocorrências observadas podem ser classificadas em <span class="math inline">\(k\)</span> categorias. Suponha que qualquer ocorrência tem probabilidade <span class="math inline">\(p_j\)</span> de pertencer a categoria <span class="math inline">\(j\)</span>. Então</p>
<ul>
<li><p>O número de ocorrências da classe <span class="math inline">\(j\)</span> é um processo de Poisson com taxa <span class="math inline">\(\lambda p_j\)</span></p></li>
<li><p>O número de ocorrências da classe <span class="math inline">\(j\)</span> é independente do número de ocorrências da classe <span class="math inline">\(i\)</span>, com <span class="math inline">\(i\neq j\)</span></p></li>
</ul>
</section>
<section id="o-processo-de-poisson-espacial" class="level3" data-number="7.1.3">
<h3 data-number="7.1.3" class="anchored" data-anchor-id="o-processo-de-poisson-espacial"><span class="header-section-number">7.1.3</span> O processo de Poisson Espacial</h3>
<p>Seja <span class="math inline">\(N(A)\)</span> o número de ocorrências observadas em uma região de área <span class="math inline">\(A\)</span>. <span class="math inline">\(N(A)\)</span> é denominado Processo de Poisson Espacial quando <span class="math inline">\(N(A)\sim\hbox{Poisson}(\lambda A)\)</span> e, para duas regiões distintas de áreas <span class="math inline">\(B\)</span> e <span class="math inline">\(C\)</span>, <span class="math inline">\(N(B)\)</span> e <span class="math inline">\(N(C)\)</span> são independentes.</p>
<p>Note que, para um Processo de Poisson Espaical, dado <span class="math inline">\(N(A)=n\)</span> as <span class="math inline">\(n\)</span> ocorrências estão uniformemente distribuídas dentro da região <span class="math inline">\(A\)</span></p>
</section>
</section>
<section id="verossimilhança-e-priori-conjugada" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="verossimilhança-e-priori-conjugada"><span class="header-section-number">7.2</span> Verossimilhança e priori conjugada</h2>
<p>Seja <span class="math inline">\(X_1,\ldots,X_n\)</span> uma amostra aleatória do modelo Poisson<span class="math inline">\((\lambda)\)</span>. A verossimilhança deste modelo é dada por</p>
<p><span class="math display">\[L(\theta)=\frac{e^{-n\theta}\theta^{\sum_{i=1}^{n}x_i}}{\prod_{i=1}^{n}x_i!}\propto \theta^{\sum_{i=1}^n x_i}e^{-n\theta}.\]</span> O modelo Poisson pertence à família exponencial e sua priori conjugada é <span class="math inline">\(\theta\sim\hbox{Gama}(r,s)\)</span> e a posteriori é <span class="math inline">\(\hbox{Gama}(r+\sum_{i=1}^n x_i, s+n)\)</span>, conforme já discutido na Introdução. Os hiperparâmetros <span class="math inline">\(r\)</span> e <span class="math inline">\(s\)</span> podem ser interpretados como o total da contagem e o tamanho da amostra a priori.</p>
<p>A média da posteriori é <span class="math display">\[E(\theta|\mathbf{x})=\frac{\sum_{i=1}^{n}x_i+r}{n+s}=\frac{n}{n+s}\bar{x}+\frac{s}{n+s}E(\theta),\]</span> onde fica claro que este estimador é uma média ponderada das informações provenientes das duas fontes de informação (sendo <span class="math inline">\(\bar{x}\)</span> a estimativa de máxima verossimilhança e <span class="math inline">\(E(\theta)\)</span> a média a priori).</p>
<p>Se <span class="math inline">\(n\gg s\)</span>, então a média a posteriori dará maior peso para a informação dos dados.</p>
</section>
<section id="preditiva-a-posteriori" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="preditiva-a-posteriori"><span class="header-section-number">7.3</span> Preditiva a posteriori</h2>
<p>A inferência bayesiana é baseada em duas fontes de informação: verossimilhança e priori. Já discutimos que, na maioria dos casos, estamos interessados em deixar a verossimilhança ter mais peso na posteriori. Agora, vamos discutir como verificar se a verossimilhança é adequada ao problema.</p>
<p>Seja <span class="math inline">\(\boldsymbol{x}=\{x_1,\ldots,x_n\}\)</span> a amostra observada e <span class="math inline">\(f(\theta|\boldsymbol{x})\)</span> a posteriori obtida. Supondo que a informação sobre os parâmetros foi capturada de forma adequada, é de se esperar que uma nova observação <span class="math inline">\(x^*\)</span> se comporte de modo semelhante a amostra observada. Podemos então obter a seguinte distribuição, denominada preditiva a posteriori:</p>
<p><span class="math display">\[\begin{align}f(x^*|\boldsymbol{x})=\int f(x^*|\theta)f(\theta|\boldsymbol{x})d\theta.\end{align}\]</span></p>
<p>Podemos comparar as características preditiva a posteriori com estatísticas livres de modelos como box-plots, histogramas, etc.</p>
<div class="alert alert-success">
<p><strong>Preditiva a posteriori para o modelo Poisson</strong></p>
<p>Para o modelo Poisson(<span class="math inline">\(\lambda\)</span>) e para a posteriori Gama<span class="math inline">\((r_1,s_1)\)</span>, onde <span class="math inline">\(r_1=r+\sum_{i=1}^n x_i\)</span> e <span class="math inline">\(s_1=n+s\)</span>, <span class="math display">\[\begin{align}
f(x^*|\boldsymbol{x})&amp;=\int_0^\infty f(x^*|\lambda)f(\lambda|\boldsymbol{x})d\lambda\\
&amp;=\int_0^\infty\frac{e^{-\lambda}\lambda^{x^*}}{x^*!}\frac{s_1^{r_1}}{\Gamma(r_1)}\lambda^{r_1-1}e^{-s_1\lambda}d\lambda\\
&amp;=\frac{s_1^{r_1}}{\Gamma(r_1)x^*!}\int_0^\infty \lambda^{r_1+x^*-1}e^{-\lambda(s_1+1)}d\lambda\\
&amp;=\frac{\Gamma(r_1+x^*)}{\Gamma(r_1)x^*!}\left(\frac{s_1}{1+s_1}\right)^{r_1}\left(1 - \frac{s_1}{s_1+1}\right)^{x^*}
\end{align}\]</span> ou seja, a preditiva a posteriori tem distribuição</p>
<p><span class="math display">\[\hbox{Binomial Negativa}\left(r_1,\frac{s_1}{1+s_1}\right).\]</span></p>
</div>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 7.1</strong></span> <strong>A Blitz e os Bombardeios de Londres</strong></p>
<p>Durante a Segunda Guerra Mundial, Londres sofreu intensos bombardeios aéreos pela Alemanha Nazista (conhecido como “Blitz”). Estatísticos analisaram a distribuição das quedas de 537 bombas pela cidade para procurar padrões.</p>
<p>Uma questão chave era se as bombas caíam aleatoriamente ou se havia algum padrão de alvo. Se as quedas de bombas fossem aleatórias, elas deveriam seguir uma distribuição de Poisson. Londres foi dividida em uma grade de com 576 setores de áreas iguais. O número de quedas de bombas em cada setor foi registrado.</p>
<table class="caption-top table">
<caption>Quedas de bombas em Londres durante o Blitz.</caption>
<colgroup>
<col style="width: 35%">
<col style="width: 64%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Número de bombas</th>
<th style="text-align: center;">Número de setores com x bombas</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">0</td>
<td style="text-align: center;">229</td>
</tr>
<tr class="even">
<td style="text-align: left;">1</td>
<td style="text-align: center;">211</td>
</tr>
<tr class="odd">
<td style="text-align: left;">2</td>
<td style="text-align: center;">93</td>
</tr>
<tr class="even">
<td style="text-align: left;">3</td>
<td style="text-align: center;">35</td>
</tr>
<tr class="odd">
<td style="text-align: left;">4</td>
<td style="text-align: center;">7</td>
</tr>
<tr class="even">
<td style="text-align: left;">5 ou mais</td>
<td style="text-align: center;">1</td>
</tr>
</tbody>
</table>
<p>Supondo que os dados seguem uma distribuição Poisson(<span class="math inline">\(\lambda\)</span>), teremos <span class="math display">\[L(\lambda)\propto e^{-576\lambda}\lambda^{537}.\]</span> Considerando a priori <span class="math inline">\(\lambda\sim\hbox{Gama}(1,1)\)</span>, teremos a posteriori Gama<span class="math inline">\((538,577)\)</span>. A preditiva a posteriori para problema é</p>
<p><span class="math display">\[\hbox{Binomial Negativa}(538,.9982).\]</span></p>
<p>Observe que podemos estimar a frequência relativa dos eventos da tabela. Podemos comparar esses resultados com o que seria esperado da preditiva. O resultado é dado a seguir.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">=</span> <span class="dv">538</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">=</span> <span class="dv">577</span><span class="sc">/</span><span class="dv">578</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Número de bombas no setor</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="st">'&gt;4'</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Frequência relativa</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">229</span>,<span class="dv">211</span>,<span class="dv">93</span>,<span class="dv">35</span>,<span class="dv">7</span>,<span class="dv">1</span>)<span class="sc">/</span><span class="dv">576</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">Preditiva a posteriori</span><span class="st">`</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">dnbinom</span>( <span class="dv">0</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">size=</span>r1, <span class="at">prob =</span> p), <span class="dv">1</span><span class="sc">-</span><span class="fu">pnbinom</span>(<span class="dv">4</span>,<span class="at">size=</span>r1,<span class="at">prob=</span>p))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">`</span><span class="at">Número de bombas no setor</span><span class="st">`</span>, <span class="st">`</span><span class="at">Frequência relativa</span><span class="st">`</span>,<span class="st">`</span><span class="at">Preditiva a posteriori</span><span class="st">`</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Número.de.bombas.no.setor Frequência.relativa Preditiva.a.posteriori
1                         0         0.397569444            0.393922155
2                         1         0.366319444            0.366661107
3                         2         0.161458333            0.170960499
4                         3         0.060763889            0.053240294
5                         4         0.012152778            0.012458045
6                        &gt;4         0.001736111            0.002757901</code></pre>
</div>
</div>
<p>A proximidade entre as frequências relativas e os resultados obtidos através da preditiva a posteriori dão evidências de que o modelo Poisson é adequado, ou ainda, que as bombas foram lançadas ao acaso.</p>
</div>
<div id="exm">
<p><strong>Número de suicídios revisitado</strong></p>
<p>Na introdução, apresentamos o número de suicídios no Amazonas para os anos 2021, 2022 e 2023. Os dados podem ser vistos abaixo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>no_suicidios <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">26</span>, <span class="dv">30</span>, <span class="dv">28</span>, <span class="dv">25</span>, <span class="dv">23</span>,<span class="dv">23</span>, <span class="dv">21</span>,</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="dv">22</span>, <span class="dv">27</span>, <span class="dv">31</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">21</span>, <span class="dv">29</span>, <span class="dv">27</span>, <span class="dv">26</span>, <span class="dv">23</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="dv">36</span>, <span class="dv">27</span>, <span class="dv">24</span>, <span class="dv">21</span>, <span class="dv">18</span>, <span class="dv">22</span>, <span class="dv">34</span>, <span class="dv">27</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">34</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="dv">22</span>, <span class="dv">27</span>, <span class="dv">25</span>, <span class="dv">32</span>, <span class="dv">36</span>, <span class="dv">28</span>, <span class="dv">22</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Analisamos estes dados e obtivemos a posteriori Gama(953.8, 37.1) para a taxa. A distribuição da preditiva a posteriori é Binomial Negativa<span class="math inline">\((953.8\;,\;0,9737)\)</span>.</p>
<p>A figura abaixo apresenta a função de distribuição empírica dos dados comparada com a função de distribuição da preditiva a posteriori. A aproximação é razoável o suficiente para aceitarmos o modelo proposto como válido.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( <span class="fu">ecdf</span>(no_suicidios), <span class="at">main =</span> <span class="st">''</span>, <span class="at">ylab=</span><span class="st">'Função de distribuição'</span>, <span class="at">xlab=</span><span class="fu">expression</span>(x))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">pnbinom</span>(x,<span class="fu">sum</span>(no_suicidios)<span class="sc">+</span><span class="dv">1</span>,<span class="dv">37</span><span class="sc">/</span><span class="dv">38</span>), <span class="at">add=</span>T, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span> <span class="st">'tomato'</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">'bottomright'</span>, <span class="fu">c</span>(<span class="st">'Empírica'</span>,<span class="st">'Preditia a posteriori'</span>), <span class="at">col=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="st">'tomato'</span>), <span class="at">bty=</span><span class="st">'n'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="poisson_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<section id="o-modelo-poisson-para-taxas" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="o-modelo-poisson-para-taxas"><span class="header-section-number">7.4</span> O modelo Poisson para taxas</h2>
<section id="modelo-de-taxa-única" class="level3" data-number="7.4.1">
<h3 data-number="7.4.1" class="anchored" data-anchor-id="modelo-de-taxa-única"><span class="header-section-number">7.4.1</span> Modelo de taxa única</h3>
<p>A taxa é o quociente entre o número de casos de um evento em determinado intervalo de tempo e a população em risco, definida em um espaço e no mesmo intervalo de tempo “pessoas-tempo”. Note que, pela definição, a taxa é uma estatística.</p>
<p>Seja <span class="math inline">\(N\)</span> o tamanho da população no espaço/tempo e seja <span class="math inline">\(y\)</span> o número de casos do evento de interesse. Então,</p>
<p><span class="math display">\[\hbox{taxa} = \frac{y}{N}\]</span></p>
<p>Contudo, como <span class="math inline">\(N\)</span> tende a ser muito maior que <span class="math inline">\(y\)</span>, é comum reportar a taxa vezes <span class="math inline">\(10^k\)</span>, para algum <span class="math inline">\(k&gt;0\)</span>. O mais comum é ter <span class="math inline">\(k=5\)</span> e esta convenção é adotada aqui.</p>
<div id="exm">
<p><strong>Crime de estupro no país</strong> Segundo o Anuário de Segurança Pública 2023, em 2022 houveram 74.930 casos de estupro. Considerando uma população de 208,2 milhões de habitantes, a taxa de estupro para aquele ano foi de <span class="math display">\[\frac{68.885}{208.200.000}\times 10^{-5}=35,98\]</span> casos por pessoa-ano.</p>
<p>Portanto, temos uma taxa de 35,98 casos para cada 100.000 habitantes.</p>
</div>
<p>Agora, considere que <span class="math inline">\(\lambda\)</span> é o parâmetro taxa. Então,</p>
<p><span class="math display">\[\hat{\lambda}=\frac{y}{N}\]</span> é a estimativa para <span class="math inline">\(\lambda\)</span>. Como <span class="math inline">\(y\)</span> é uma contagem, é razoável supor que <span class="math display">\[\lambda =\frac{1}{N}E(Y|\lambda),\]</span> e um modelo com essa parametrização seria <span class="math inline">\(y|\lambda\sim\hbox{Poisson}(\lambda N)\)</span>. Observe que, na prática <span class="math inline">\(N\)</span> já está dividido por <span class="math inline">\(10^5\)</span>.</p>
<div id="exm">
<p><strong>Crime de estupro no país (cont.)</strong> Seja <span class="math inline">\(y\)</span> o número de crimes de estupro dados no exemplo anterior. Seja <span class="math inline">\(n=212.700.000/10^5=2082\)</span> a população do país dividida por <span class="math inline">\(10^5\)</span>. Considerando o modelo <span class="math inline">\(y|\lambda\hbox{Poisson}(2082\lambda)\)</span> temos a seguinte verossimilhança para <span class="math inline">\(\lambda\)</span>:</p>
<p><span class="math display">\[L(\lambda)\propto \lambda^{74930}e^{-2082\lambda  }\]</span> Utilizando a priori Gama(1,1) (que representa um caso para cada 100.000 habitantes), teremos a posteriori Gama(74931,2083) e a estimativa <span class="math display">\[E(\lambda|y)=\frac{74931}{2083}=35,97.\]</span> ou seja, 35,97 casos a cada 100.000 habitantes.</p>
</div>
<p>Agora, considere que a população está particionada em <span class="math inline">\(m\)</span> localidades. Sejam <span class="math inline">\(N_i\)</span> e <span class="math inline">\(y_i\)</span> a população da localidade <span class="math inline">\(i\)</span> e seu respectivo número de casos observados. Suponha ainda que a taxa <span class="math inline">\(\lambda\)</span> é comum para a população e que <span class="math inline">\(y_i\)</span> e <span class="math inline">\(y_j\)</span> são independentes dado <span class="math inline">\(\lambda\)</span>. Assumindo a distribuição Poisson, teremos</p>
<p><span class="math display">\[L(\lambda)=\prod_{i=1}^m\frac{e^{-\lambda n_i}(\lambda N_i)^{y_i}}{y_i!}\varpropto \lambda^{\sum_{i=1}^m y_i}e^{-\lambda \sum_{i=1}^m N_i}=\lambda^{\sum_{i=1}^n y_i}e^{-\lambda N},\]</span> onde <span class="math inline">\(N=\sum_{i=1}^m N_i\)</span> é o tamanho da população. Como a verossimilhança pertence à família exponencial, temos que o modelo Gama<span class="math inline">\((r,s)\)</span> é conjugado gerando a posteriori</p>
<p><span class="math display">\[\lambda|\mathbf{y}\sim\hbox{Gama}\left(\sum_{i=1}^{m}y_i+r,N+s\right)\equiv \hbox{Gamma}(r_1,s_1).\]</span> Observe que essa posteriori é identica a obtida no exemplo anterior, quando consideramos o número de casos na população.</p>
<p>Considere agora um novo valor observado da localidade <span class="math inline">\(i\)</span>. Sua preditiva a posteriori é dada por</p>
<p><span class="math display">\[\begin{align}
f(y^*_i|\boldsymbol{y})&amp;=\int_0^\infty f(y^*_i|\lambda)f(\lambda|\boldsymbol{y})d\lambda\\
&amp;\int_0^\infty \frac{e^{-\lambda N_i}(\lambda N_i)^{y_i^*}}{y_i^*!}\frac{s_1^{r_1}}{\Gamma(r_1)}\lambda^{r_1-1}e^{-\lambda s_1}d\lambda\\
&amp;=\frac{\Gamma(r_1+y_i^*)}{y_i^*!\Gamma(r_1)}\left(\frac{s_i}{N_i+s_i}\right)^{r_1}\left(1-\frac{s_i}{N_i+s_i}\right)^{y_i^*},
\end{align}\]</span> ou seja, <span class="math display">\[y_i^*|\boldsymbol{y}\sim\text{Binomial Negativa}\left(r_1,\frac{s_1}{N_i+s_1}\right),\]</span> cujo valor esperado é <span class="math display">\[E(y_i^*|\boldsymbol{y})=\frac{r_1}{s_1}N_i.\]</span></p>
<p>Deste modo, a taxa da preditiva a posteriori é dada por <span class="math display">\[E(\frac{y_i^*}{N_i}|\boldsymbol{y})=\frac{r_1}{s_1}\]</span> e podemos comparar o ajuste considerando a distribuição de <span class="math inline">\(y^*_i/N_i\)</span> com <span class="math inline">\(y_i/N_i\)</span>.</p>
<div id="exm">
<p><strong>Crime de estupro no país (cont.)</strong> Os dados deste exemplo estão no banco abaixo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">require</span>(gsheet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Carregando pacotes exigidos: gsheet</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: pacote 'gsheet' foi compilado no R versão 4.4.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">'https://docs.google.com/spreadsheets/d/11Sr8mqilWCe6Dj8TO6PgTYpJT292vbon1XnB0Co1Trc/edit?usp=sharing'</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>dados <span class="ot">&lt;-</span> <span class="fu">gsheet2tbl</span>(url)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dados)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 27 × 3
   `Unidade Federativa (UF)` `População Estimada (2023)` `Crimes de estupro`
   &lt;chr&gt;                                           &lt;dbl&gt;               &lt;dbl&gt;
 1 Acre                                           830018                 745
 2 Alagoas                                       3127511                1040
 3 Amapá                                          733759                 628
 4 Amazonas                                      4145525                 836
 5 Bahia                                        14659023                4558
 6 Ceará                                         9187078                1897
 7 Distrito Federal                              2817068                 754
 8 Espírito Santo                                4018650                1736
 9 Goiás                                         7206589                3667
10 Maranhão                                      6775152                2273
# ℹ 17 more rows</code></pre>
</div>
</div>
<p>Utilizando a posteriori Gama(74931,2083), teremos que <span class="math display">\[y_i^*|\hbox{dados}\sim\hbox{Binomial Negativa}\left(74931,\frac{2083}{N_i+2083}\right).\]</span></p>
<p>Podemos construir intervalos de 95% (de predição) para <span class="math inline">\(y^*_i\)</span> utilizando os quantis da preditiva a posteriori, ou seja, encontrando <span class="math inline">\(q_1\)</span> e <span class="math inline">\(q_2\)</span> tais que <span class="math display">\[\begin{align}
P(Y_i^*\leq q_1|\boldsymbol{y})&amp;=0,025\\
P(Y_i^*\leq q_2|\boldsymbol{y})&amp;=0,975.
\end{align}
\]</span></p>
<p>Observe ainda que <span class="math display">\[0,95\approx P(q_1\leq Y_i^*\leq q_2|\boldsymbol{y})=P\left(\frac{q_1}{N_i}\leq \frac{Y_i^*}{N_i}\leq \frac{q_2}{N_i}|\boldsymbol{y}\right),\]</span> o que implica que <span class="math inline">\((q_1,q_2)/N_i\)</span> é um intervalo de predição de 95% para taxa esperada. Abaixo construímos estes intervalos e contrastamos com a taxa observada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># taxas observadas</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fu">unlist</span>(dados[,<span class="dv">2</span>]<span class="sc">/</span><span class="dv">100000</span>)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>taxas <span class="ot">&lt;-</span> <span class="fu">unlist</span>(dados[,<span class="dv">3</span>]<span class="sc">/</span>N)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="co"># posteriori</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">=</span> <span class="dv">74931</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">=</span> <span class="dv">2083</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limites do intervalo da preditiva a posteriori</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>lim_inf <span class="ot">&lt;-</span> <span class="fu">qnbinom</span>(.<span class="dv">025</span>, <span class="at">size =</span> r1, <span class="at">prob =</span> s1<span class="sc">/</span>(N<span class="sc">+</span>s1))</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>lim_sup <span class="ot">&lt;-</span> <span class="fu">qnbinom</span>(.<span class="dv">975</span>, <span class="at">size =</span> r1, <span class="at">prob =</span> s1<span class="sc">/</span>(N<span class="sc">+</span>s1))</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># gráfico</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>cores <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'red'</span>,<span class="st">'green4'</span>,<span class="st">'red'</span>,<span class="fu">rep</span>(<span class="st">'orange'</span>,<span class="dv">4</span>),<span class="st">'red'</span>,<span class="st">'red'</span>,<span class="st">'green4'</span>,</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>          <span class="st">'red'</span>,<span class="st">'red'</span>,<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'orange'</span>,<span class="st">'red'</span>),<span class="dv">2</span>), <span class="st">'orange'</span>,<span class="st">'green4'</span>,<span class="st">'green4'</span>,<span class="st">'orange'</span>,<span class="fu">rep</span>(<span class="st">'red'</span>,<span class="dv">4</span>),<span class="st">'orange'</span>,<span class="st">'green4'</span>,<span class="st">'red'</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.window</span>( <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">70</span>,<span class="dv">120</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">27</span>))</span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(lim_inf<span class="sc">/</span>N,<span class="dv">1</span><span class="sc">:</span><span class="dv">27</span>,lim_sup<span class="sc">/</span>N,<span class="dv">1</span><span class="sc">:</span><span class="dv">27</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="dv">70</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">27</span>, <span class="fu">unlist</span>(dados[,<span class="dv">1</span>]), <span class="at">adj =</span><span class="dv">0</span> ,<span class="at">col=</span>cores)</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(taxas, <span class="dv">1</span><span class="sc">:</span><span class="dv">27</span>, <span class="at">pch =</span> <span class="dv">22</span>, <span class="at">cex =</span>.<span class="dv">9</span>, <span class="at">bg =</span> cores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="poisson_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Observe que o modelo de considera uma taxa única para o país se ajusta bem para os estados Alagoas, Maranhão, Piauí, Rio de Janeiro e Sergipe. Unidades da Federação como Amazonas, Bahia, Ceará, Distrito Federal, Minas Gerais, Pernambuco, Rio Grande do Norte e São Paulo, possuem taxas menores do que as preditas. Os demais estados possuem taxas maiores do que as preditas.</p>
</div>
</section>
<section id="modelo-com-várias-taxas" class="level3" data-number="7.4.2">
<h3 data-number="7.4.2" class="anchored" data-anchor-id="modelo-com-várias-taxas"><span class="header-section-number">7.4.2</span> Modelo com várias taxas</h3>
<p>O último exemplo da seção anterior mostra que o modelo com taxa única pode ser falho. Existem algumas explicações para este fenômeno, como:</p>
<ul>
<li><p>O evento observado não depende apenas do tamanho da população. O crime de estupro, por exemplo, depende de variáveis como vunerabilidade social e aparelhamento do estado para o acolhimento das vítimas.</p></li>
<li><p>O evento observado pode ser raro. Eventos raros são mais difíceis de serem observados em populações menores, o que causa distorções.</p></li>
</ul>
<p>Podemos tentar mitigar os efeitos acima considerando um modelo no qual cada região possui sua própria taxa, i.e.</p>
<p><span class="math display">\[y_i|\lambda_i\sim\hbox{Poisson}(\lambda_i N_i).\]</span> Considerando a priori <span class="math inline">\(\lambda_i\sim\hbox{Gama}(r,s)\)</span>, teremos</p>
<p><span class="math display">\[\begin{align}
\lambda_i| \hbox{dados} &amp; \sim \hbox{Gama}(r+y_i,s+N_i)\\
y^*_i|\hbox{Dados}&amp;\sim\hbox{Binomial Negativa}\left(r+y_i,\frac{s}{s+N_i}\right)
\end{align}\]</span></p>
<p>Observe que mesmo que cada região tenha a sua própria taxa, a informação a priori é a mesma para todas elas. Deste modo, é importante que a priori reflita as várias possibilidades de taxas.</p>
<div id="exm">
<p><strong>Crime de estupro no país (cont.)</strong> Considere que as taxas para cada unidade da federação são independentes e identicamente distribuídas. Abaixo apresentamos a densidade estimada via método do núcleo para as taxas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(taxas))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dgamma</span>(x,<span class="dv">100</span>,.<span class="dv">5</span>),<span class="at">add =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="poisson_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Vimos na Introdução que uma priori Gama<span class="math inline">\((r,s)\)</span> pode ser elicitada utilizando as seguintes fórmulas:</p>
<p><span class="math display">\[\begin{align}a&amp;=\left(\frac{\hbox{média}}{desvio}\right)^2\\
b=\frac{a}{\hbox{média}}\end{align}\]</span></p>
<p>Fazendo os cálculos abaixo</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>media <span class="ot">=</span> <span class="fu">mean</span>(taxas)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>desvio <span class="ot">=</span> <span class="fu">sd</span>(taxas)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> (media<span class="sc">/</span>desvio)<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>s <span class="ot">=</span> r<span class="sc">/</span>media</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>r;s</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.608031</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.07758706</code></pre>
</div>
</div>
<p>A próxima figura reapresenta a densidade estimada em conjunto com a densidade Gama(3,6;,;0,07)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">density</span>(taxas))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dgamma</span>(x,<span class="fl">3.6</span>,.<span class="dv">07</span>),<span class="at">add =</span> T, <span class="at">lwd =</span> <span class="dv">2</span>, <span class="at">col =</span><span class="st">'tomato'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="poisson_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Vamos utilizar a priori <span class="math inline">\(\lamda_i\sim\hbox{Gama}(3,6\;,\;0,07)\)</span> para reanalizar este banco de dados, agora com múltiplas taxas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hiperparametrosr</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">=</span> <span class="fl">3.6</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>s <span class="ot">=</span> .<span class="dv">07</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># posterioris</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>r1 <span class="ot">=</span> <span class="fu">unlist</span>(dados[,<span class="dv">3</span>])<span class="sc">+</span>r</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>s1 <span class="ot">=</span> N <span class="sc">+</span> s</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="co"># limites do intervalo da preditiva a posteriori</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>lim_inf <span class="ot">&lt;-</span> <span class="fu">qnbinom</span>(.<span class="dv">025</span>, <span class="at">size =</span> r1, <span class="at">prob =</span> s1<span class="sc">/</span>(N<span class="sc">+</span>s1))</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>lim_sup <span class="ot">&lt;-</span> <span class="fu">qnbinom</span>(.<span class="dv">975</span>, <span class="at">size =</span> r1, <span class="at">prob =</span> s1<span class="sc">/</span>(N<span class="sc">+</span>s1))</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a><span class="co"># gráfico</span></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>cores <span class="ot">=</span> <span class="fu">c</span>(<span class="st">'red'</span>,<span class="st">'green4'</span>,<span class="st">'red'</span>,<span class="fu">rep</span>(<span class="st">'orange'</span>,<span class="dv">4</span>),<span class="st">'red'</span>,<span class="st">'red'</span>,<span class="st">'green4'</span>,</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>          <span class="st">'red'</span>,<span class="st">'red'</span>,<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">'orange'</span>,<span class="st">'red'</span>),<span class="dv">2</span>), <span class="st">'orange'</span>,<span class="st">'green4'</span>,<span class="st">'green4'</span>,<span class="st">'orange'</span>,<span class="fu">rep</span>(<span class="st">'red'</span>,<span class="dv">4</span>),<span class="st">'orange'</span>,<span class="st">'green4'</span>,<span class="st">'red'</span>)</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.new</span>()</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot.window</span>( <span class="at">xlim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">70</span>,<span class="dv">120</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">27</span>))</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(lim_inf<span class="sc">/</span>N,<span class="dv">1</span><span class="sc">:</span><span class="dv">27</span>,lim_sup<span class="sc">/</span>N,<span class="dv">1</span><span class="sc">:</span><span class="dv">27</span>, <span class="at">lwd =</span> <span class="dv">2</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a><span class="fu">text</span>(<span class="sc">-</span><span class="dv">70</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">27</span>, <span class="fu">unlist</span>(dados[,<span class="dv">1</span>]), <span class="at">adj =</span><span class="dv">0</span> ,<span class="at">col=</span>cores)</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(taxas, <span class="dv">1</span><span class="sc">:</span><span class="dv">27</span>, <span class="at">pch =</span> <span class="dv">22</span>, <span class="at">cex =</span>.<span class="dv">9</span>, <span class="at">bg =</span> cores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="poisson_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="exercícios" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="exercícios"><span class="header-section-number">7.5</span> Exercícios</h2>
<section id="mortes-por-coice-de-cavalo" class="level3" data-number="7.5.1">
<h3 data-number="7.5.1" class="anchored" data-anchor-id="mortes-por-coice-de-cavalo"><span class="header-section-number">7.5.1</span> Mortes por coice de cavalo</h3>
<p>Ladislaus Bortkiewicz é o responsável pela popularização da distribuição Poisson. Em seu livro intitulado A Lei dos Pequenos Números, é apresentado um conjunto de dados no qual foi rastreado o número de mortes por coice de cavalo em 14 corpos do exército prussiano ao longo de 20 anos (de 1875 a 1894).</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Mortes por corpo <span class="math inline">\(\times\)</span> ano</th>
<th>0</th>
<th>1</th>
<th>2</th>
<th>3</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>109</td>
<td>65</td>
<td>22</td>
<td>3</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>Determine se a distribuição Poisson é adequada para este conjunto de dados. Em caso afirmativo, estime a taxa e dê um intervalo de credibilidade de 95%.</p>
</section>
<section id="suicídios-no-amazonas-considerando-capital-e-interior" class="level3" data-number="7.5.2">
<h3 data-number="7.5.2" class="anchored" data-anchor-id="suicídios-no-amazonas-considerando-capital-e-interior"><span class="header-section-number">7.5.2</span> Suicídios no Amazonas considerando capital e interior</h3>
<p>O Amazonas possui uma característica peculiar: aproximadamente 50% da população vive na capital. Vimos anteriormente que o número de suicídios, considerando os anos entre 2021 e 2023, podem ser modelados por uma Poisson. A tabela abaixo divide esses dados entre capital e interior.</p>
<table class="caption-top table">
<caption>Número de suicídios divididos entre capital e interior</caption>
<thead>
<tr class="header">
<th>Ano</th>
<th>2021</th>
<th>2022</th>
<th>2023</th>
<th>Total</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Capital</td>
<td>133</td>
<td>124</td>
<td>138</td>
<td>395</td>
</tr>
<tr class="even">
<td>Interior</td>
<td>164</td>
<td>173</td>
<td>201</td>
<td>538</td>
</tr>
</tbody>
</table>
<p>Determine se há evidências de que essas taxas são diferentes.</p>
</section>
<section id="crime-de-estupro-de-vulnerável-no-interior-do-amazonas" class="level3" data-number="7.5.3">
<h3 data-number="7.5.3" class="anchored" data-anchor-id="crime-de-estupro-de-vulnerável-no-interior-do-amazonas"><span class="header-section-number">7.5.3</span> Crime de estupro de vulnerável no interior do Amazonas**</h3>
<p>Os dados a seguir foram cedidos pelo Observatório de Violência de Gênero no Amazonas e compreendem os anos entre 2010 e 2012. A população em risco é o número de mulheres com menos de 14 anos.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Cidade</th>
<th>Vítimas</th>
<th>Populacao feminina</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Amatura</td>
<td>3</td>
<td>639</td>
</tr>
<tr class="even">
<td>Atalaia do Norte</td>
<td>6</td>
<td>905</td>
</tr>
<tr class="odd">
<td>Barreirinha</td>
<td>12</td>
<td>1899</td>
</tr>
<tr class="even">
<td>Benjamin Constant</td>
<td>2</td>
<td>2036</td>
</tr>
<tr class="odd">
<td>Boa Vista do Ramos</td>
<td>6</td>
<td>1060</td>
</tr>
<tr class="even">
<td>Fonte Boa</td>
<td>0</td>
<td>1438</td>
</tr>
<tr class="odd">
<td>Jutai</td>
<td>1</td>
<td>1143</td>
</tr>
<tr class="even">
<td>Maues</td>
<td>13</td>
<td>3421</td>
</tr>
<tr class="odd">
<td>Nhamunda</td>
<td>9</td>
<td>1168</td>
</tr>
<tr class="even">
<td>Parintins</td>
<td>20</td>
<td>6700</td>
</tr>
<tr class="odd">
<td>Santo Antonio do Ica</td>
<td>7</td>
<td>1608</td>
</tr>
<tr class="even">
<td>Sao Paulo de Olivenca</td>
<td>5</td>
<td>2033</td>
</tr>
<tr class="odd">
<td>Tabatinga</td>
<td>8</td>
<td>3095</td>
</tr>
<tr class="even">
<td>Tonantins</td>
<td>1</td>
<td>1186</td>
</tr>
</tbody>
</table>
<p>Verifique se é possível utilizar uma única taxa para explicar este banco de dados. Em caso contrário, estime uma taxa para cada município. O que você pode destacar de sua análise?</p>


</section>
</section>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./teste.html" class="pagination-link" aria-label="Testes de hipóteses">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Testes de hipóteses</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./normal.html" class="pagination-link" aria-label="O modelo normal">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">O modelo normal</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>