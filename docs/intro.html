<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>2&nbsp; Introdução – Introdução à Inferência Bayesiana</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./conjugada.html" rel="next">
<link href="./summary.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./intro.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introdução</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introdução à Inferência Bayesiana</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">summary.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introdução</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conjugada.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Famílias conjugadas</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./estimacao.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">O estimador de bayes</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./bernoulli.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">O modelo Bernoulli</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./teste.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Testes de hipóteses</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./normal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">O modelo normal</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./negativeBinomial.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Binomial negativa</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./aproximacaoNormal.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Aproximação normal e seu uso com o Metropolis-Hastings</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./misturas.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Misturas de distribuições</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./poisson.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">O modelo Poisson revisitado</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#dados-que-serão-utilizados-nesse-capítulo" id="toc-dados-que-serão-utilizados-nesse-capítulo" class="nav-link active" data-scroll-target="#dados-que-serão-utilizados-nesse-capítulo"><span class="header-section-number">2.1</span> Dados que serão utilizados nesse capítulo</a></li>
  <li><a href="#notação" id="toc-notação" class="nav-link" data-scroll-target="#notação"><span class="header-section-number">2.2</span> Notação</a></li>
  <li><a href="#fontes-de-informação" id="toc-fontes-de-informação" class="nav-link" data-scroll-target="#fontes-de-informação"><span class="header-section-number">2.3</span> Fontes de informação</a>
  <ul class="collapse">
  <li><a href="#a-função-de-verossimilhança" id="toc-a-função-de-verossimilhança" class="nav-link" data-scroll-target="#a-função-de-verossimilhança"><span class="header-section-number">2.3.1</span> A função de verossimilhança</a></li>
  <li><a href="#a-distribuição-a-priori" id="toc-a-distribuição-a-priori" class="nav-link" data-scroll-target="#a-distribuição-a-priori"><span class="header-section-number">2.3.2</span> A distribuição a priori</a></li>
  <li><a href="#reunindo-as-fontes-de-informação---distribuição-a-posteriori" id="toc-reunindo-as-fontes-de-informação---distribuição-a-posteriori" class="nav-link" data-scroll-target="#reunindo-as-fontes-de-informação---distribuição-a-posteriori"><span class="header-section-number">2.3.3</span> Reunindo as fontes de informação - distribuição a posteriori</a></li>
  </ul></li>
  <li><a href="#inferência-estatística" id="toc-inferência-estatística" class="nav-link" data-scroll-target="#inferência-estatística"><span class="header-section-number">2.4</span> Inferência estatística</a></li>
  <li><a href="#exercício" id="toc-exercício" class="nav-link" data-scroll-target="#exercício"><span class="header-section-number">2.5</span> Exercício</a></li>
  <li><a href="#resumo-da-aula-1" id="toc-resumo-da-aula-1" class="nav-link" data-scroll-target="#resumo-da-aula-1"><span class="header-section-number">2.6</span> Resumo da aula 1</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Introdução</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Os objetivos desta aula são:</p>
<ol type="1">
<li>Apresentar a notação</li>
<li>Explicar sobre as fontes de informação</li>
<li>Apresentar as inferências básicas</li>
<li>Discutir como se dá o processo de elicitação de prioris</li>
</ol>
<section id="dados-que-serão-utilizados-nesse-capítulo" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="dados-que-serão-utilizados-nesse-capítulo"><span class="header-section-number">2.1</span> Dados que serão utilizados nesse capítulo</h2>
<p>A amostra abaixo se refere ao número mensal de suicídios registrados no Amazonas nos anos 2021, 2022 e 2023.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>no_suicidios <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">19</span>, <span class="dv">26</span>, <span class="dv">30</span>, <span class="dv">28</span>, <span class="dv">25</span>, <span class="dv">23</span>,<span class="dv">23</span>, <span class="dv">21</span>,</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="dv">22</span>, <span class="dv">27</span>, <span class="dv">31</span>, <span class="dv">22</span>, <span class="dv">23</span>, <span class="dv">21</span>, <span class="dv">29</span>, <span class="dv">27</span>, <span class="dv">26</span>, <span class="dv">23</span>,</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="dv">36</span>, <span class="dv">27</span>, <span class="dv">24</span>, <span class="dv">21</span>, <span class="dv">18</span>, <span class="dv">22</span>, <span class="dv">34</span>, <span class="dv">27</span>, <span class="dv">26</span>, <span class="dv">26</span>, <span class="dv">34</span>,</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="dv">22</span>, <span class="dv">27</span>, <span class="dv">25</span>, <span class="dv">32</span>, <span class="dv">36</span>, <span class="dv">28</span>, <span class="dv">22</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Desta amostra, inferimos que a média mensal é de 25,9 registros e que a variância é 21,05.</p>
</section>
<section id="notação" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="notação"><span class="header-section-number">2.2</span> Notação</h2>
<p>Variáveis aleatórias cujos valores podem ser observados serão denotadas por letras maiúsculas. Exemplos:</p>
<ul>
<li><p><span class="math inline">\(X\)</span> é o número de acidentes diários na Avenida Torquato Tapajós</p></li>
<li><p><span class="math inline">\(Y\)</span> é o nível máximo diário do Rio Negro</p></li>
</ul>
<p>Valores observados de variáveis aleatórias serão denotados pela respectiva letra minúscula.</p>
<p>Parâmetros serão considerados aleatórios, mas serão representados por letras gregas minúsculas, como <span class="math inline">\(\theta\)</span>, <span class="math inline">\(\lambda\)</span>, etc.</p>
<p>Vetores aleatórios serão representados por letras em negrito. Exemplos:</p>
<ul>
<li><p><span class="math inline">\(\mathbf{X} = \{X_1 , \ldots , X_n \}\)</span> é um vetor de variáveis aleatórias.</p></li>
<li><p><span class="math inline">\(\mathbf{x} = \{x_1 ,\ldots , x_n \}\)</span> é um vetor observado de variáveis aleatórias.</p></li>
<li><p><span class="math inline">\(\theta=\{\alpha,\beta\}\)</span> é um vetor de parâmetros.</p></li>
</ul>
<div id="def-Suporte" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.1</strong></span> O suporte de uma variável aleatória é o conjunto de todos os seus possíveis valores. Quando necessário, o suporte de variáveis aleatórias é representado pela versão caligráfica de sua letra correspondente.</p>
<p>Exemplos: o suporte de <span class="math inline">\(X\)</span> é <span class="math inline">\(\mathcal{X}\)</span> ; o suporte de Y é <span class="math inline">\(\mathcal{Y}\)</span> ; o suporte de <span class="math inline">\(Z\)</span> é <span class="math inline">\(\mathcal{Z}\)</span>.</p>
</div>
<div id="def-Espaco" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.2</strong></span> O espaço paramétrico é o conjunto de todos os possíveis valores do parâmetro. Ele é representado pela versão maiúscula da letra grega utilizada para seu respectivo parâmetro.</p>
<p>Exemplo: o espaço paramétrico do parâmetro <span class="math inline">\(\theta\)</span> é representado por <span class="math inline">\(\Theta\)</span>.</p>
</div>
<p>Tanto a função de densidade quanto a de probabilidade serão denotadas por funções começando com letras minúsculas. Por exemplo,</p>
<p><span class="math display">\[f(x|\lambda)=\lambda e^{-\lambda x}\]</span> onde <span class="math inline">\(x,\lambda&gt;0\)</span> é a densidade da distribuição exponencial, enquanto que</p>
<p><span class="math display">\[p(x|\lambda)=\frac{e^{-\lambda}\lambda^x}{x!}\]</span> com <span class="math inline">\(x\in\mathbb{N}\)</span> e <span class="math inline">\(\lambda &gt;0\)</span> é a função de probabilidade da distribuição Poisson.</p>
</section>
<section id="fontes-de-informação" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="fontes-de-informação"><span class="header-section-number">2.3</span> Fontes de informação</h2>
<section id="a-função-de-verossimilhança" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="a-função-de-verossimilhança"><span class="header-section-number">2.3.1</span> A função de verossimilhança</h3>
<p>Seja <span class="math inline">\(\mathbf{x} = \{x_1 , \ldots , x_n \}\)</span> uma amostra observada. Supomos que <span class="math inline">\(\mathbf{x}\)</span> é uma das possíveis amostras das variáveis aleatórias <span class="math inline">\(\mathbf{X} = \{X_1 , \ldots , X_n \}\)</span>. Supomos ainda que <span class="math inline">\(X\sim F (.|\theta)\)</span>. Assim, condicionada ao conhecimento de <span class="math inline">\(\theta\)</span>, a distribuição da amostra está completamente especificada.</p>
<p>::: {#def-Funcao de verossimilhanca} Para <span class="math inline">\(\mathbf{x}\)</span> fixado, a função <span class="math display">\[L:\Theta\Rightarrow [0,\infty)\]</span> é denominada verossimilhança. :::</p>
<p>Sua interpretação é a seguinte: para <span class="math inline">\(\theta_1,\theta_2\in\Theta\)</span>, se</p>
<p><span class="math display">\[L(\theta_1)&gt;L(\theta_2),\]</span> dizemos que <span class="math inline">\(\theta_1\)</span> é mais verossímil que <span class="math inline">\(\theta_2\)</span>. Isto porque a probabilidade de observar uma amostra na vizinhança de <span class="math inline">\(\mathbf{x}\)</span> é maior se considerarmos que <span class="math inline">\(\theta_1\)</span> é o valor do parâmetro. A verossimilhança é uma das fontes de informação utilizada na inferência bayesiana (e a única fonte da inferência frequentista).</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 2.1</strong></span> Seja <span class="math inline">\(X_i\)</span> o número de suicídios no <span class="math inline">\(i\)</span>-ésimo mês da amostra e suponha que <span class="math inline">\(X_1,\ldots,X_{36}\)</span> é uma amostra aleatória proveniente do modelo Poisson(<span class="math inline">\(\theta\)</span>). Como <span class="math inline">\(\sum_i x_i=933\)</span>, a função de verossimilhança será <span class="math display">\[L(\theta)=\prod_{i=1}^{36}\frac{e^{-\theta}\theta^{x_i}}{x_i!}\propto e^{-36\theta}\theta^{933}.\]</span></p>
<p>A próxima figura mostra os valores da função de verossimilhança para diversos valores de <span class="math inline">\(\theta\)</span> para a amostra observada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># função de verossimilhança</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>vero <span class="ot">&lt;-</span> <span class="cf">function</span>(q){</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">sapply</span> ( q, <span class="cf">function</span>(q) <span class="fu">prod</span>(<span class="fu">dpois</span>(no_suicidios, q)) ) </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>} </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co"># gráfico da função de verossimilhança</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>oo <span class="ot">&lt;-</span> <span class="fu">par</span>( <span class="at">cex =</span> <span class="fl">1.2</span>)</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>( <span class="fu">vero</span>(x),<span class="dv">22</span>,<span class="dv">30</span>, <span class="at">xlab =</span> <span class="fu">expression</span>(theta), <span class="at">ylab =</span> <span class="fu">expression</span>( <span class="fu">L</span>(theta)) , <span class="at">lwd =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(oo)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Podemos notar que o valores mais verossímeis para <span class="math inline">\(\theta\)</span> estão entre 24 e 28. Podemos ainda procurar o valor mais verossímil, denominado <strong>estimativa de máxima verossimilhança (emv).</strong> Pode-se mostrar, utilizando cálculo diferencial, que este valor é equivalente à média amostral. Contudo, com o objetivo de utilizar ao máximo o poder computacional que temos disponível, vamos encontrar esse valor utilizando a função <code>optimize</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># menos o logaritmo da função de verossimilhança</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>lvero <span class="ot">&lt;-</span> <span class="cf">function</span>(q) <span class="sc">-</span><span class="fu">log</span>( <span class="fu">vero</span>(q))</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># encontrando a emv:</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">optimise</span>(lvero, <span class="fu">c</span>(<span class="dv">24</span>,<span class="dv">28</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$minimum
[1] 25.91666

$objective
[1] 105.4219</code></pre>
</div>
</div>
<p>O valor 25,9 é a estimativa de verossimilhança. Sob o ponto de vista frequentista, esta seria a nossa estimativa para o valor de <span class="math inline">\(\theta\)</span>.</p>
</div>
</section>
<section id="a-distribuição-a-priori" class="level3" data-number="2.3.2">
<h3 data-number="2.3.2" class="anchored" data-anchor-id="a-distribuição-a-priori"><span class="header-section-number">2.3.2</span> A distribuição a priori</h3>
<p>Sob o ponto de vista bayesiano, a informação existente sobre <span class="math inline">\(\theta\)</span> antes da observação da amostra deve ser levada em consideração. Isto é feito traduzindo tal informação em termos de probabilidades.</p>
<div id="def-" class="theorem definition">
<p><span class="theorem-title"><strong>Definition 2.3</strong></span> A distribuição de <span class="math inline">\(\theta\)</span> é denominada <strong>distribuição a priori</strong>.</p>
</div>
<div>
<p>Os parâmetros da distribuição <strong>a priori</strong> são denominados hiperparâmetros.</p>
</div>
<p>As distribuições a priori agregam o conhecimento sobre parâmetro antes da observação da amostra (tal conhecimento pode pode vir da expertize dos envolvidos ou ter sido gerado de uma amostra prévia).</p>
<p>As prioris podem ser muito ou pouco informativas, dependendo do grau de crença sobre os valores particulares do espaço paramétrico. Em geral isto é feito alterando a variância da distribuição:</p>
<p><span class="math display">\[\hbox{variância}=\frac{1}{\hbox{precisão}}\]</span></p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 2.2</strong></span> Nosso objetivo é encontrar uma distribuição a priori para <span class="math inline">\(\theta\)</span>, que representa o número médio de suicídios mensais no Amazonas. Primeiro, vamos obter algumas informações:</p>
<ul>
<li><p>Em 2024 foi noticiado que, no Brasil, ocorrem em média 38 suicídios por dia, algo em torno de 1.140 suicídios em um mês.</p></li>
<li><p>Para 2024, a população brasileira estava estimada em 212.600.000, enquanto que a população do Amazonas estava estimada em 4.281.209. Portanto, o Amazonas representa, aproximadamente 2% da população brasileira.</p></li>
<li><p>Deste modo, pode-se inferir (a priori) que, em média, ocorrem 22,8 suicídios mensais no Amazonas.</p></li>
</ul>
<p>Podemos então procurar alguma distribuição a priori que reflita essa informação. Por mera conveniência, vamos escolher <span class="math inline">\(\theta\sim\hbox{Gama}(a,b)\)</span>, onde <span class="math inline">\(E(\theta)=\frac{a}{b}=22,8.\)</span></p>
<p>Um especialista em saúde pública poderia argumentar melhor se há motivos para acreditar que essa média deveria ser maior ou não. Como não temos essa informação disponível, podemos refletir esse fato aumentando a variabilidade do modelo. O desvio padrão desta priori é</p>
<p><span class="math display">\[\sqrt{Var(\theta)}=\frac{\sqrt{a}}{b}=\frac{E(\theta)}{\sqrt{a}}=\frac{22,8}{\sqrt{a}}.\]</span></p>
<p>Vamos escolher esse desvio igual 5. Isto implica que <span class="math display">\[a=\left(\frac{22,8}{5}\right)^2=20,8\]</span> e <span class="math display">\[b=\frac{22,8}{20,8}=1,1.\]</span> Então, nossa informação a priori está traduzida no modelo Gama(20.8,1.1). Abaixo, apresentamos a função densidade desse modelo. Observe que esse modelo traz informações vagas sobre <span class="math inline">\(\theta\)</span>, permitindo que ele assuma valores entre 10 e 30</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">curve</span>(<span class="fu">dgamma</span>(x,<span class="fl">20.8</span>, <span class="fl">1.1</span>), <span class="dv">10</span>,<span class="dv">35</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
<section id="reunindo-as-fontes-de-informação---distribuição-a-posteriori" class="level3" data-number="2.3.3">
<h3 data-number="2.3.3" class="anchored" data-anchor-id="reunindo-as-fontes-de-informação---distribuição-a-posteriori"><span class="header-section-number">2.3.3</span> Reunindo as fontes de informação - distribuição a posteriori</h3>
<p>Sejam <span class="math inline">\(f(\boldsymbol{\theta})\)</span> a densidade/função para <span class="math inline">\(\boldsymbol{\theta}\)</span> e <span class="math inline">\(L(\boldsymbol{\theta})\)</span> a função de verossimilhança.</p>
<p>Como <span class="math inline">\(\boldsymbol{\theta}\)</span> é considerado aleatório, podemos analisar sua distribuição <strong>após</strong> observar a amostra <span class="math inline">\(\boldsymbol{x}\)</span>, ou seja <span class="math display">\[\boldsymbol{\theta}|\boldsymbol{x}.\]</span></p>
<p>Esta distribuição é denominada </p>
<p>::: {#thm-Teorema de Bayes}</p>
<p>Seja <span class="math inline">\(\boldsymbol{x}\)</span> uma amostra observada. Considere a priori <span class="math inline">\(\theta\sim f(\theta)\)</span> e a verossimilhança <span class="math inline">\(L(\theta)\)</span>. Então a função de densidade (ou probabilidade) de <span class="math inline">\(\theta|\boldsymbol{x}\)</span> é dada por <span class="math display">\[f(\theta|\boldsymbol{x})=\frac{L(\theta)f(\theta)}{f(\boldsymbol{x})}.\]</span> O denominador é denominado distribuição preditiva, sendo igual a <span class="math display">\[f(\boldsymbol{x})=\sum_{\theta\in \Theta}L(\theta)f(\theta),\]</span> se <span class="math inline">\(\theta\)</span> é v.a. discreta ou <span class="math display">\[f(\boldsymbol{x})=\int_{\Theta}L(\theta)f(\theta)d\theta\]</span> se <span class="math inline">\(\theta\)</span> é v.a. contínua. :::</p>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 2.3</strong></span> Considerando os dados de suicídios do começo desse capítulo, temos as seguintes fontes de informação:</p>
<ul>
<li><p>Verossimilhança: <span class="math display">\[L(\theta)\propto e^{-36\theta}\theta^{933}\]</span></p></li>
<li><p>Priori <span class="math display">\[f(\theta)\propto \theta^{19,8}e^{-1,1\theta}\]</span></p></li>
</ul>
<p>A distribuição a posteriori será</p>
<p><span class="math display">\[f(\theta|x_1,\ldots,x_{36})\propto \theta^{933+19,8}e^{-(36+1,1)\theta}=\theta^{952,8}e^{-37,1\theta}.\]</span> Assim, verificamos que <span class="math inline">\(\theta|x_1,\ldots,x_{36}\sim\hbox{Gama}(953.8,37.1)\)</span>. Na figura abaixo, apresentamos no mesmo gráfico, a função de verossimilhança, priori e posteriori (fazendo as mudanças de escala necessárias). Observe que a priori é mais dispersa que a verossimilhança. Essa, por sua vez, restringe os valores de <span class="math inline">\(\theta\)</span> que eram prováveis a priori. O resutaldo é uma distribuição a posteriori próxima da função de verossimilhança.</p>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="intro_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="inferência-estatística" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="inferência-estatística"><span class="header-section-number">2.4</span> Inferência estatística</h2>
<p>Denominamos por estatística qualquer função da amostra. Utilizamos estatísticas para fazer as seguintes inferências:</p>
<ul>
<li><p><em>Estimação pontual</em>: trata-se de uma estatística com o objetivo de inferir o valor de <span class="math inline">\(\theta\)</span>. Tal estatística é denominada <strong>estimador</strong>.</p></li>
<li><p><em>Estimação por região</em>: trata-se de uma estatística, digamos <span class="math inline">\(T(\boldsymbol{X})\)</span>, com o objetivo de cobrir o valor de <span class="math inline">\(\theta\)</span>, ou seja, fazer a inferência <span class="math inline">\(\theta\in T(\boldsymbol{X})\)</span>. As estimações intervalares são as mais comuns, nas quais <span class="math inline">\(T(\boldsymbol{X})=(L(\boldsymbol{X}),U(\boldsymbol{X}))\)</span>.</p></li>
<li><p><em>Testes de hipóteses</em>: são estatísticas construídas para decidir se aceitamos a afirmação (hipótese) <span class="math inline">\(H:\theta\in \Theta_0\)</span>, onde <span class="math inline">\(\Theta_0\)</span> é um subconjunto de <span class="math inline">\(\Theta\)</span> conhecido por hipótese.</p></li>
</ul>
<p>Note que a distribuição <strong>a posteriori</strong> é função da amostra. Assim, toda função desta distribuição é uma estatística. Assim:</p>
<ul>
<li><p><em>Estimação pontual</em>: em geral é uma medida que representa a região de alta densidade (ou probabilidade) da <strong>posteriori</strong>. A média da posteriori, assim como a mediana ou a moda são escolhas comuns.</p></li>
<li><p><em>Estimação por regiões</em>: em geral procuramos por uma região <span class="math inline">\(T\)</span> da posteriori que satisfaça <span class="math inline">\(P(\theta\in T(\boldsymbol{x})|\boldsymbol{x})=\gamma\)</span>, onde <span class="math inline">\(\gamma\)</span> é denominado nível de credibilidade (não confundir com nível de confiança)</p></li>
<li><p><em>Testes de hipóteses</em>: em geral, aceitamos <span class="math inline">\(H:\theta\in\Theta_0\)</span> se <span class="math inline">\(P(H|\boldsymbol{x})\)</span> é elevada.</p></li>
</ul>
<div id="exm-" class="theorem example">
<p><span class="theorem-title"><strong>Example 2.4</strong></span> Para o nosso exemplo, obtivemos <span class="math inline">\(\theta|\boldsymbol{x}\sim\hbox{Gama}(953.8,37.1)\)</span>. Então, uma estimativa pontual para <span class="math inline">\(\theta\)</span> é</p>
<p><span class="math display">\[E(\theta|\boldsymbol{x})=\frac{953,8}{37,1}=25,7\]</span> registros de suicídios mensais.</p>
<p>Podemos obter os quantis de 2,5% e 97,5% para construir um intervalo com 95% de credibilidade:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qgamma</span>( <span class="fu">c</span>(.<span class="dv">025</span>,.<span class="dv">975</span>), <span class="fl">953.8</span>, <span class="fl">37.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24.10301 27.36583</code></pre>
</div>
</div>
<p>logo, inferimos que <span class="math inline">\(\theta\in(24.1,27.36)\)</span> com probabilidade 0,95.</p>
<p>Por último, recorde-se que discutimos, utilizando apenas os dados nacionais, que <span class="math inline">\(\theta\)</span> deveria está próximo de 22,8. Após observa a amostra, existem evidências de que <span class="math inline">\(H:\theta&gt;22,8\)</span>? Para responder a esse questionamento, podemos calcular</p>
<p><span class="math display">\[P(H|\boldsymbol{x})=P(\theta&gt;22.8|\boldsymbol{x})\]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">-</span><span class="fu">pgamma</span>(<span class="fl">22.8</span>, <span class="fl">953.8</span>, <span class="fl">37.1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.9998554</code></pre>
</div>
</div>
<p>logo, com uma probabilidade maior que 99,9%, existem fortes evidências de que o número médio mensal de suicídios no Amazonas é maior do que 22,8 registros por mês.</p>
</div>
</section>
<section id="exercício" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="exercício"><span class="header-section-number">2.5</span> Exercício</h2>
<div class="alert alert-warning">
<p>É fato que a taxa de suicídio é maior entre os homens, embora a tentativa seja maior entre as mulheres. Uma das explicações está no fato de que os homens tendem a utilizar métodos mais letais para o suicídio, como armas de fogo, enquanto as mulheres são mais propensas a utilizar métodos menos letais, como overdose de medicamentos.</p>
<p>Dados históricos, entre 1996 e 2017, sugerem que 79% dos suicídios são cometidos por homens.</p>
<p>Seja <span class="math inline">\(\rho\)</span> a probabilidade de que um suicídio seja cometido por alguém do sexo masculino no Estado do Amazonas. Considere a priori <span class="math inline">\(\rho\sim\hbox{Beta}(a,b)\)</span>, onde sabemos que</p>
<p><span class="math display">\[f(\rho)\propto \rho^{a-1}(1-\rho)^{b-1},\]</span> <span class="math display">\[E(\rho)=\frac{a}{a+b},\]</span> e <span class="math display">\[Var(\rho)=\frac{E(\rho)(1-E(\rho))}{a+b+1}.\]</span></p>
<ul>
<li><p>Encontre valores de <span class="math inline">\(a\)</span> e <span class="math inline">\(b\)</span> que reflitam a média de 0,79 mas que não restrinjam demais os valores possíveis para <span class="math inline">\(\rho\)</span></p></li>
<li><p>No Amazonas, entre os anos 2021 e 2023, dos 933 registros de suicídios, 726 foram cometidos por homens. Considere então o modelo <span class="math inline">\(X|\rho\sim\hbox{Binomial}(933,\rho)\)</span>. Mostre que <span class="math display">\[f(\theta|x)\propto \rho^{726+a-1}(1-\rho)^{207+b-1}\]</span> e conclua que <span class="math inline">\(\rho|x\sim\hbox{Beta}(a+933,b+207)\)</span>.</p></li>
<li><p>Estime <span class="math inline">\(\theta\)</span> e construa um intervalo de 95% de credibilidade</p></li>
<li><p>Teste a hipótese de que, para o Amazonas, a probabilidade de um indivíduo do sexo masculino cometer suicídio é maior do que 79%.</p></li>
<li><p>Para problemas envolvendo proporções, é comum o uso a priori <span class="math inline">\(\rho\sim\hbox{Uniforme}(0,1)\)</span>, que é equivalente à <span class="math inline">\(\rho\sim\hbox{Beta}(1,1)\)</span>. Refaça este exercício com essa priori e discuta sobre as diferenças encontradas tanto nas estimações quanto no teste de hipóteses.</p></li>
</ul>
</div>
</section>
<section id="resumo-da-aula-1" class="level2" data-number="2.6">
<h2 data-number="2.6" class="anchored" data-anchor-id="resumo-da-aula-1"><span class="header-section-number">2.6</span> Resumo da aula 1</h2>
<ul>
<li><p>Existem duas fontes de informação na inferência bayesiana: os dados (verossimilhança) e a informação anterior (priori)</p></li>
<li><p>A informação <strong>a priori</strong> é subjetiva: pessoas diferentes têm prioris diferentes</p></li>
<li><p>O Teorema de Bayes combina as duas fontes em uma nova informação, dada pela distribuição </p></li>
<li><p>Os objetivos da inferência (estimação e testes) são feitos a partir da distribuição <strong>a posteriori</strong></p></li>
</ul>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./summary.html" class="pagination-link" aria-label="summary.html">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">summary.html</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./conjugada.html" class="pagination-link" aria-label="Famílias conjugadas">
        <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Famílias conjugadas</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>