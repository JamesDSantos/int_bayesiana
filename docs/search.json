[
  {
    "objectID": "poisson.html",
    "href": "poisson.html",
    "title": "7  O modelo Poisson",
    "section": "",
    "text": "7.1 Sobre o modelo\nSeja \\(N(t)\\) o número de ocorrências observadas no intervalo de tempo \\([0,t]\\) (considere que \\(N(0)=0\\)). Note que o número de eventos no intervalo \\((s,t]\\) é dado por \\(N(t)-N(s)\\).\nDizemos que \\(N(t)\\) tem incrementos independentes se, para quaisquer intervalos disjuntos \\((s_0,t_0]\\) e \\((s_1,t_1]\\), as contagens \\(N(t_0)-N(s_0)\\) e \\(N(t_1)-N(s_1)\\) são independentes.\n\\(N(t)\\) é denominado Processo de Poisson quando ele possui incrementos indepentes e, para qualquer intervalo \\((s,t]\\),\n\\[P(N(t)-N(s)=x)=\\frac{e^{-\\lambda(t-s)[\\lambda(t-s)]^x}}{x!},\\] onde \\(x=0,1,\\ldots\\) e \\(\\lambda&gt;0\\). Isto implica que \\[E(N(t))=\\lambda t,\\] ou seja, o número esperado de ocorrências até o tempo \\(t\\) é diretamente proporcional à \\(t\\) e \\(\\lambda\\) representa a taxa de crescimento. Para este processo, é verdade que \\[\\lim_{\\delta\\rightarrow 0}P(N(t+\\delta)-N(t)&gt;1)=0,\\] ou seja, não é possível observar duas ou mais ocorrências simultaneamente.\nEm geral, os experimentos são desenhados para registrar contagens em intervalos regulares e disjuntos de tempo, como semanas ou anos. Considere que tais intervalos são \\([0,s_1],(s_1,s_2],\\ldots,(s_{n-1},t]\\) e seja \\(c\\) o comprimento destes intervalos. Em geral, os dados são apresentados como contagens dentro destes intevalos, gerando as seguintes variáveis:",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>O modelo Poisson</span>"
    ]
  },
  {
    "objectID": "poisson.html#sobre-o-modelo",
    "href": "poisson.html#sobre-o-modelo",
    "title": "7  O modelo Poisson",
    "section": "",
    "text": "\\(X_1=N(s_1)\\sim\\hbox{Poisson}(\\lambda c)\\)\n\\(X_2=N(s_2)-N(s_1)\\sim\\hbox{Poisson}(\\lambda c)\\)\n\\(\\cdots\\)\n\\(X_n=N(t)-N(s_{n-1})\\sim\\hbox{Poisson}(\\lambda c)\\) ou seja, \\(X_1,\\ldots,X_n\\) são uma amostra aleatória do modelo Poisson(\\(\\lambda c\\)). Na prática, \\(c=1\\) por ser a unidade de medida de tempo associada ao experimento (uma semana, um ano, etc).\n\n\n7.1.1 Tempos de chegadas e tempos de espera\nPara um processo de Poisson \\(N(t)\\), definimos o tempo de chegadas como o tempo entre duas observações consecutivas. Denotaremos o tempo de chegadas entre a \\(i\\)-ésima e a \\(i-1\\) ésima ocorrência por \\(T_i\\).\nÉ possível mostrar que \\(T_i\\) é independente de \\(T_j\\), para \\(i\\neq j\\) e que \\(T_i\\sim\\hbox{Exponencial}(\\lambda)\\). Por isso, para uma amostra aleatória de um modelo Exponencial(\\(\\lambda\\)), o parâmetro \\(\\lambda\\) é demoninado taxa.\nDefinimos por tempo de espera da ocorrência \\(n\\) como o tempo transcorrido desde o início do processo até a ocorrência do \\(n\\)-ésimo evento. Este tempo de espera é denotado por \\(S_n\\). Exsitem dois resultados importantes relacionados ao tempo de espera:\n\n\\(S_n=T_1+\\cdots+T_n\\) tem distribuição Gama(\\(n,\\lambda\\))\nDado que \\(N(t)=n\\), os tempos de espera dos eventos estão uniformemente distribuídos dentro do intervalo \\((0,t)\\).\n\n\n\n7.1.2 Ocorrências de diversas classes\nSuponha que as ocorrências observadas podem ser classificadas em \\(k\\) categorias. Suponha que qualquer ocorrência tem probabilidade \\(p_j\\) de pertencer a categoria \\(j\\). Então\n\nO número de ocorrências da classe \\(j\\) é um processo de Poisson com taxa \\(\\lambda p_j\\)\nO número de ocorrências da classe \\(j\\) é independente do número de ocorrências da classe \\(i\\), com \\(i\\neq j\\)\n\n\n\n7.1.3 O processo de Poisson Espacial\nSeja \\(N(A)\\) o número de ocorrências observadas em uma região de área \\(A\\). \\(N(A)\\) é denominado Processo de Poisson Espacial quando \\(N(A)\\sim\\hbox{Poisson}(\\lambda A)\\) e, para duas regiões distintas de áreas \\(B\\) e \\(C\\), \\(N(B)\\) e \\(N(C)\\) são independentes.\nNote que, para um Processo de Poisson Espaical, dado \\(N(A)=n\\) as \\(n\\) ocorrências estão uniformemente distribuídas dentro da região \\(A\\)",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>O modelo Poisson</span>"
    ]
  },
  {
    "objectID": "poisson.html#verossimilhança-e-priori-conjugada",
    "href": "poisson.html#verossimilhança-e-priori-conjugada",
    "title": "7  O modelo Poisson",
    "section": "7.2 Verossimilhança e priori conjugada",
    "text": "7.2 Verossimilhança e priori conjugada\nSeja \\(X_1,\\ldots,X_n\\) uma amostra aleatória do modelo Poisson\\((\\lambda)\\). A verossimilhança deste modelo é dada por\n\\[L(\\theta)=\\frac{e^{-n\\theta}\\theta^{\\sum_{i=1}^{n}x_i}}{\\prod_{i=1}^{n}x_i!}\\propto \\theta^{\\sum_{i=1}^n x_i}e^{-n\\theta}.\\] O modelo Poisson pertence à família exponencial e sua priori conjugada é \\(\\theta\\sim\\hbox{Gama}(r,s)\\) e a posteriori é \\(\\hbox{Gama}(r+\\sum_{i=1}^n x_i+r, s+n)\\), conforme já discutido na Introdução. Os hiperparâmetros \\(r\\) e \\(s\\) podem ser interpretados como o total da contagem e o tamanho da amostra a priori.\nA média da posteriori é \\[E(\\theta|\\mathbf{x})=\\frac{\\sum_{i=1}^{n}x_i+r}{n+s}=\\frac{n}{n+s}\\bar{x}+\\frac{s}{n+s}E(\\theta),\\] onde fica claro que este estimador é uma média ponderada das informações provenientes das duas fontes de informação (sendo \\(\\bar{x}\\) a estimativa de máxima verossimilhança e \\(E(\\theta)\\) a média a priori).\nSe \\(n\\gg s\\), então a média a posteriori dará maior peso para a informação dos dados.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>O modelo Poisson</span>"
    ]
  },
  {
    "objectID": "poisson.html#preditiva-a-posteriori",
    "href": "poisson.html#preditiva-a-posteriori",
    "title": "7  O modelo Poisson",
    "section": "7.3 Preditiva a posteriori",
    "text": "7.3 Preditiva a posteriori\nA inferência bayesiana é baseada em duas fontes de informação: verossimilhança e priori. Já discutimos que, na maioria dos casos, estamos interessados em deixar a verossimilhança ter mais peso na posteriori. Agora, vamos discutir como verificar se a verossimilhança é adequada ao problema.\nSeja \\(\\boldsymbol{x}=\\{x_1,\\ldots,x_n\\}\\) a amostra observada e \\(f(\\theta|\\boldsymbol{x})\\) a posteriori obtida. Supondo que a informação sobre os parâmetros foi capturada de forma adequada, é de se esperar que uma nova observação \\(x^*\\) se comporte de modo semelhante a amostra observada. Podemos então obter a seguinte distribuição, denominada preditiva a posteriori:\n\\[\\begin{align}f(x^*|\\boldsymbol{x})=\\int f(x^*|\\theta)f(\\theta|\\boldsymbol{x})d\\theta.\\end{align}\\]\nPodemos comparar as características preditiva a posteriori com estatísticas livres de modelos como box-plots, histogramas, etc.\n\nPreditiva a posteriori para o modelo Poisson\nPara o modelo Poisson(\\(\\lambda\\)) e para a posteriori Gama\\((r_1,s_1)\\), onde \\(r_1=r+\\sum_{i=1}^n x_i\\) e \\(s_1=n+s\\), \\[\\begin{align}\nf(x^*|\\boldsymbol{x})&=\\int_0^\\infty f(x^*|\\lambda)f(\\lambda|\\boldsymbol{x})d\\lambda\\\\\n&=\\int_0^\\infty\\frac{e^{-\\lambda}\\lambda^{x^*}}{x^*!}\\frac{s_1^{r_1}}{\\Gamma(r_1)}\\lambda^{r_1-1}e^{-s_1\\lambda}d\\lambda\\\\\n&=\\frac{s_1^{r_1}}{\\Gamma(r_1)x^*!}\\int_0^\\infty \\lambda^{r_1+x^*-1}e^{-\\lambda(s_1+1)}d\\lambda\\\\\n&=\\frac{\\Gamma(r_1+x^*)}{\\Gamma(r_1)x^*!}\\left(\\frac{s_1}{1+s_1}\\right)^{r_1}\\left(1 - \\frac{s_1}{s_1+1}\\right)^{x^*}\n\\end{align}\\] ou seja, a preditiva a posteriori tem distribuição\n\\[\\hbox{Binomial Negativa}\\left(r_1,\\frac{s_1}{1+s_1}\\right).\\]\n\n\nExample 7.1 A Blitz e os Bombardeios de Londres\nDurante a Segunda Guerra Mundial, Londres sofreu intensos bombardeios aéreos pela Alemanha Nazista (conhecido como “Blitz”). Estatísticos analisaram a distribuição das quedas de 537 bombas pela cidade para procurar padrões.\nUma questão chave era se as bombas caíam aleatoriamente ou se havia algum padrão de alvo. Se as quedas de bombas fossem aleatórias, elas deveriam seguir uma distribuição de Poisson. Londres foi dividida em uma grade de com 576 setores de áreas iguais. O número de quedas de bombas em cada setor foi registrado.\n\nQuedas de bombas em Londres durante o Blitz.\n\n\n\n\n\n\nNúmero de bombas\nNúmero de setores com x bombas\n\n\n\n\n0\n229\n\n\n1\n211\n\n\n2\n93\n\n\n3\n35\n\n\n4\n7\n\n\n5 ou mais\n1\n\n\n\nSupondo que os dados seguem uma distribuição Poisson(\\(\\lambda\\)), teremos \\[L(\\lambda)\\propto e^{-576\\lambda}\\lambda^{537}.\\] Considerando a priori \\(\\lambda\\sim\\hbox{Gama}(1,1)\\), teremos a posteriori Gama\\((538,577)\\). A preditiva a posteriori para problema é\n\\[\\hbox{Binomial Negativa}(538,.9982).\\]\nObserve que podemos estimar a frequência relativa dos eventos da tabela. Podemos comparar esses resultados com o que seria esperado da preditiva. O resultado é dado a seguir.\n\nr1 = 538\np = 577/578\n`Número de bombas no setor` &lt;- c(0,1,2,3,4,'&gt;4')\n`Frequência relativa` &lt;- c(229,211,93,35,7,1)/576\n`Preditiva a posteriori` &lt;- c(dnbinom( 0:4, size=r1, prob = p), 1-pnbinom(4,size=r1,prob=p))\n\ndt &lt;- data.frame(`Número de bombas no setor`, `Frequência relativa`,`Preditiva a posteriori`)\n\nprint(dt)\n\n  Número.de.bombas.no.setor Frequência.relativa Preditiva.a.posteriori\n1                         0         0.397569444            0.393922155\n2                         1         0.366319444            0.366661107\n3                         2         0.161458333            0.170960499\n4                         3         0.060763889            0.053240294\n5                         4         0.012152778            0.012458045\n6                        &gt;4         0.001736111            0.002757901\n\n\nA proximidade entre as frequências relativas e os resultados obtidos através da preditiva a posteriori dão evidências de que o modelo Poisson é adequado, ou ainda, que as bombas foram lançadas ao acaso.\n\n\nNúmero de suicídios revisitado\nNa introdução, apresentamos o número de suicídios no Amazonas para os anos 2021, 2022 e 2023. Os dados podem ser vistos abaixo.\n\nno_suicidios &lt;- c(19, 26, 30, 28, 25, 23,23, 21,\n22, 27, 31, 22, 23, 21, 29, 27, 26, 23,\n36, 27, 24, 21, 18, 22, 34, 27, 26, 26, 34,\n22, 27, 25, 32, 36, 28, 22 )\n\nAnalisamos estes dados e obtivemos a posteriori Gama(953.8, 37.1) para a taxa. A distribuição da preditiva a posteriori é Binomial Negativa\\((953.8\\;,\\;0,9737)\\).\nA figura abaixo apresenta a função de distribuição empírica dos dados comparada com a função de distribuição da preditiva a posteriori. A aproximação é razoável o suficiente para aceitarmos o modelo proposto como válido.\n\nplot( ecdf(no_suicidios), main = '', ylab='Função de distribuição', xlab=expression(x))\ncurve(pnbinom(x,sum(no_suicidios)+1,37/38), add=T, lwd = 2, col = 'tomato')\nlegend('bottomright', c('Empírica','Preditia a posteriori'), col=c(1,'tomato'), bty='n')\n\n\n\n\n\n\n\n\n\n7.4 O modelo Poisson para taxas\nA taxa é o cociente entre o número de casos de um evento em determinado intervalo de tempo e a população em risco, definida em um espaço e no mesmo intervalo de tempo “pessoas-tempo”. Note que, pela definição, a taxa é uma estatística.\nSeja \\(N\\) o tamanho da população no espaço/tempo e seja \\(y\\) o número de casos do evento de interesse. Então,\n\\[\\hbox{taxa} = \\frac{y}{N}\\]\nContudo, como \\(N\\) tende a ser muito maior que \\(y\\), é comum reportar a taxa vezes \\(10^k\\), para algum \\(k&gt;0\\).\n\nExemplo: Segundo o Anuário de Segurança Pública 2022, em 2021 houveram 68.885 casos de estupro. Considerando uma população de 212,7 milhões de habitantes, a taxa de estupro para aquele ano foi de \\[\\frac{68.885}{212.700.000}=3,23\\times 10^{-4}\\] casos por pessoa-ano.\nMultiplicando a taxa por \\(10^5\\), temos uma taxa de 32,3 casos para cada 100.000 habitantes.\n\nAgora,considere que \\(\\lambda\\) é o parâmetro taxa (ou seja, caso por \\(10^k\\) pessoas). Então,\n\\[\\hat{\\lambda}=\\frac{y}{N}\\] é a estimativa para \\(\\lambda\\). Como \\(y\\) é uma contagem, é razoável supor que \\[\\lambda =\\frac{1}{N}E(Y|\\lambda),\\] e um modelo com essa parametrização seria \\(y|\\lambda\\sim\\hbox{Poisson}(\\lambda n)\\).\nAgora, considere que a população está particionada em \\(m\\) localidades. Para um dado intervalo de tempo, sejam \\(N_i\\) e \\(y_i\\) a população da localidade \\(i\\) e seu respectivo número de casos observados. Suponha ainda que a taxa \\(\\lambda\\) é comum para a população e que \\(y_i\\) e \\(y_j\\) são independentes dado \\(\\lambda\\). Assumindo a distribuição Poisson, teremos\n\\[L(\\lambda)=\\prod_{i=1}^m\\frac{e^{-\\lambda n_i}(\\lambda N_i)^{y_i}}{y_i!}\\varpropto \\lambda^{\\sum_{i=1}^m y_i}e^{-\\lambda \\sum_{i=1}^m N_i}=\\lambda^{\\sum_{i=1}^n y_i}e^{-\\lambda N},\\] onde \\(N=\\sum_{i=1}^m N_i\\) é o tamanho da população. Como a verossimilhança pertence à família exponencial, temos que o modelo Gama\\((r,s)\\) é conjugado gerando a posteriori\n\\[\\lambda|\\mathbf{y}\\sim\\hbox{Gama}\\left(\\sum_{i=1}^{m}y_i+r,N+s\\right)\\equiv \\hbox{Gamma}(r_1,s_1).\\]\nConsidere agora um novo valor observado da localidade \\(i\\). Sua preditiva a posteriori é dada por\n\\[\\begin{align}\nf(y^*_i|\\boldsymbol{y})&=\\int_0^\\infty f(y^*_i|\\lambda)f(\\lambda|\\boldsymbol{y})d\\lambda\\\\\n&\\int_0^\\infty \\frac{e^{-\\lambda N_i}(\\lambda N_i)^{y_i^*}}{y_i^*!}\\frac{s_1^{r_1}}{\\Gamma(r_1)}\\lambda^{r_1-1}e^{-\\lambda s_1}d\\lambda\\\\\n&=\\frac{\\Gamma(r_1+y_i^*)}{y_i^*!\\Gamma(r_1)}\\left(\\frac{s_i}{N_i+s_i}\\right)^{r_1}\\left(1-\\frac{s_i}{N_i+s_i}\\right)^{y_i^*},\n\\end{align}\\] ou seja, \\[y_i^*|\\boldsymbol{y}\\sim\\text{Binomial Negativa}\\left(r_1,\\frac{s_1}{N_i+s_1}\\right),\\] cujo valor esperado é \\[E(y_i^*|\\boldsymbol{y})=\\frac{r_1}{s_1}N_i.\\] Observe que \\(y_1^*\\) e \\(y_j^*\\) possuem a mesma distribuição somente se \\(N_i=N_j\\).\n\n\n\n\nUnidade Federativa\nPopulação Estimada (1º de Julho de 2024)\n\n\n\n\nSão Paulo\n45.973.194\n\n\nMinas Gerais\n21.322.691\n\n\nRio de Janeiro\n17.219.679\n\n\nBahia\n14.850.513\n\n\nParaná\n11.824.665\n\n\nRio Grande do Sul\n11.229.915\n\n\nPernambuco\n9.539.029\n\n\nCeará\n9.233.656\n\n\nPará\n8.664.306\n\n\nSanta Catarina\n8.058.441\n\n\nGoiás\n7.350.483\n\n\nMaranhão\n7.010.960\n\n\nAmazonas\n4.281.209\n\n\nParaíba\n4.145.040\n\n\nEspírito Santo\n4.102.129\n\n\nMato Grosso\n3.836.399\n\n\nRio Grande do Norte\n3.446.071\n\n\nPiauí\n3.375.646\n\n\nAlagoas\n3.220.104\n\n\nDistrito Federal\n\n\n\nMato Grosso do Sul\n2.901.895\n\n\nSergipe\n2.291.077\n\n\nRondônia\n1.746.227\n\n\nTocantins\n1.577.342\n\n\nAcre\n880.631\n\n\nAmapá\n802.837\n\n\nRoraima\n716.793\n\n\n\n\n\nCrime de estupro de vulnerável no interior do Amazonas\nOs dados a seguir foram cedidos pelo Observatório de Violência de Gênero no Amazonas e compreendem os anos entre 2010 e 2012. A população em risco é o número de mulheres co menos de 14 anos.\n\n\n\nCidade\nVítimas\nPopulacao feminina\n\n\n\n\nAmatura\n3\n639\n\n\nAtalaia do Norte\n6\n905\n\n\nBarreirinha\n12\n1899\n\n\nBenjamin Constant\n2\n2036\n\n\nBoa Vista do Ramos\n6\n1060\n\n\nFonte Boa\n0\n1438\n\n\nJutai\n1\n1143\n\n\nMaues\n13\n3421\n\n\nNhamunda\n9\n1168\n\n\nParintins\n20\n6700\n\n\nSanto Antonio do Ica\n7\n1608\n\n\nSao Paulo de Olivenca\n5\n2033\n\n\nTabatinga\n8\n3095\n\n\nTonantins\n1\n1186\n\n\n\nAbaixo, organizamos os dados. A população é dividida por \\(10^5\\) para que a taxa seja interpretada como número de casos para cada 100.000 mulheres menores de 14 anos.\n\n# banco de dados\ncasos &lt;- c( 3, 6, 12, 2, 6, 0, 1, 13, 9, 20, 7, 5, 8, 1 )   \n\npop &lt;- c(639, 905, 1899, 2036, 1060, 1438, 1143, 3421, 1168, 6700, 1608, 2033, 3095, 1186)\npop &lt;- pop/10^5\n\nmunicipios &lt;- c( 'Amaturá', 'Ataláia do Norte', 'Barreirinha', 'Benjamin Constant','Boa Vista do Ramos', 'Fonte Boa', 'Jutaí', 'Maués', 'Nhamunda', 'Parintins', 'Sto Antônio do Iça', 'São Paulo de Olivença', 'Tabatinga','Tonantins')\n\nA veromissilhança é dada por \\[L(\\lambda)\\propto \\lambda^{93}e^{-0,28331\\lambda }.\\] Utilizando a priori \\(\\lambda\\sim\\hbox{Gama}(.5,.00001)\\), teremos a posteriori \\(\\lambda\\sim\\hbox{Gama}(93.5,0.28332)\\)\nVamos calcular o número de casos esperado segundo a preditiva a posteriori para cada município.\n\nr &lt;- .5\ns &lt;- .00001\n\nr1 &lt;- sum(casos) + r\ns1 &lt;- sum(pop) + s\n\nesperado &lt;- r1 * pop / s1\n\nO gráfico abaixo apresenta o valor da média da preditiva a posteriori contra o número de casos observados. Como esperado, os pares ordenados flutuam em torno da linha \\(y=x\\).\n\nplot(casos, esperado, xlab = 'Casos observados', ylab = 'Casos esperados')\nabline(0,1,lty = 2)\n\n\n\n\n\n\n\n\nMesmo que os pontos no gráfico acima estejam flutuando em torno da reta \\(y=x\\), é importante determinar se sua distância até a reta é razoável. Podemos construir intervalos de 95% (de predição) para \\(y^*_i\\) utilizando os quantis da preditiva a posteriori, ou seja, encontrando \\(q_1\\) e \\(q_2\\) tais que \\[\\begin{align}\nP(Y_i^*\\leq q_1|\\boldsymbol{y})&=0,025\\\\\nP(Y_i^*\\leq q_2|\\boldsymbol{y})&=0,975.\n\\end{align}\n\\]\nObserve ainda que \\[0,95\\approx P(q_1\\leq Y_i^*\\leq q_2|\\boldsymbol{y})=P\\left(\\frac{q_1}{N_i}\\leq \\frac{Y_i^*}{N_i}\\leq \\frac{q_2}{N_i}|\\boldsymbol{y}\\right),\\] o que implica que \\((q_1,q_2)/N_i\\) é um intervalo para taxa esperada. Abaixo construímos os intervalos de 95% (de predição) e colocamos o número de casos observados.\n\n# limites do intervalo\nlim_inf &lt;- qnbinom(.025, size = r1, prob = s1/(pop+s1))\n\nlim_sup &lt;- qnbinom(.975, size = r1, prob = s1/(pop+s1))\n\n# gráfico\nplot.new()\nplot.window( xlim = c(-500,1000), ylim=c(0,15))\nsegments(lim_inf/pop,1:14,lim_sup/pop,1:14, lwd = 2)\ntext(-500,1:14, municipios, adj =0 )\npoints(casos/pop, 1:14, pch = 22, cex =.9, bg = 'red')\n\n\n\n\n\n\n\n\nAlguns municípios, como Nanhunda, foram substimados, enquanto outros, como Fonte Boa, foram superestimados. Para estes 14 intervalos, é esperado que \\(14\\times 0,05=0,7\\) deles não cubram \\(y_i\\), o que não está ocorrendo. Portanto, considerar que todos os municípios possuem a mesma taxa pode ser um equívoco.\n\n\n\n7.5 Exercícios\n\n7.5.1 Mortes por coice de cavalo\nLadislaus Bortkiewicz é o responsável pela popularização da distribuição Poisson. Em seu livro intitulado A Lei dos Pequenos Números, é apresentado um conjunto de dados no qual foi rastreado o número de mortes por coice de cavalo em 14 corpos do exército prussiano ao longo de 20 anos (de 1875 a 1894).\n\n\n\nMortes por corpo \\(\\times\\) ano\n0\n1\n2\n3\n\n\n\n\n109\n65\n22\n3\n1\n\n\n\nDetermine se a distribuição Poisson é adequada para este conjunto de dados. Em caso afirmativo, estime a taxa e dê um intervalo de credibilidade de 95%.\n\n\n7.5.2 Suicídios no Amazonas considerando capital e interior\nO Amazonas possui uma característica peculiar: aproximadamente 50% da população vive na capital. Vimos anteriormente que o número de suicídios, considerando os anos entre 2021 e 2023, podem ser modelados por uma Poisson. A tabela abaixo divide esses dados entre capital e interior.\n\nNúmero de suicídios divididos entre capital e interior\n\n\nAno\n2021\n2022\n2023\nTotal\n\n\n\n\nCapital\n133\n124\n138\n395\n\n\nInterior\n164\n173\n201\n538\n\n\n\nDetermine se há evidências de que essas taxas são diferentes.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>O modelo Poisson</span>"
    ]
  },
  {
    "objectID": "poisson.html#o-modelo-poisson-para-taxas",
    "href": "poisson.html#o-modelo-poisson-para-taxas",
    "title": "7  O modelo Poisson",
    "section": "7.4 O modelo Poisson para taxas",
    "text": "7.4 O modelo Poisson para taxas\nA taxa é o cociente entre o número de casos de um evento em determinado intervalo de tempo e a população em risco, definida em um espaço e no mesmo intervalo de tempo “pessoas-tempo”. Note que, pela definição, a taxa é uma estatística.\nSeja \\(N\\) o tamanho da população no espaço/tempo e seja \\(y\\) o número de casos do evento de interesse. Então,\n\\[\\hbox{taxa} = \\frac{y}{N}\\]\nContudo, como \\(N\\) tende a ser muito maior que \\(y\\), é comum reportar a taxa vezes \\(10^k\\), para algum \\(k&gt;0\\).\n\nExemplo: Segundo o Anuário de Segurança Pública 2022, em 2021 houveram 68.885 casos de estupro. Considerando uma população de 212,7 milhões de habitantes, a taxa de estupro para aquele ano foi de \\[\\frac{68.885}{212.700.000}=3,23\\times 10^{-4}\\] casos por pessoa-ano.\nMultiplicando a taxa por \\(10^5\\), temos uma taxa de 32,3 casos para cada 100.000 habitantes.\n\nAgora,considere que \\(\\lambda\\) é o parâmetro taxa (ou seja, caso por \\(10^k\\) pessoas). Então,\n\\[\\hat{\\lambda}=\\frac{y}{N}\\] é a estimativa para \\(\\lambda\\). Como \\(y\\) é uma contagem, é razoável supor que \\[\\lambda =\\frac{1}{N}E(Y|\\lambda),\\] e um modelo com essa parametrização seria \\(y|\\lambda\\sim\\hbox{Poisson}(\\lambda n)\\).\nAgora, considere que a população está particionada em \\(m\\) localidades. Para um dado intervalo de tempo, sejam \\(N_i\\) e \\(y_i\\) a população da localidade \\(i\\) e seu respectivo número de casos observados. Suponha ainda que a taxa \\(\\lambda\\) é comum para a população e que \\(y_i\\) e \\(y_j\\) são independentes dado \\(\\lambda\\). Assumindo a distribuição Poisson, teremos\n\\[L(\\lambda)=\\prod_{i=1}^m\\frac{e^{-\\lambda n_i}(\\lambda N_i)^{y_i}}{y_i!}\\varpropto \\lambda^{\\sum_{i=1}^m y_i}e^{-\\lambda \\sum_{i=1}^m N_i}=\\lambda^{\\sum_{i=1}^n y_i}e^{-\\lambda N},\\] onde \\(N=\\sum_{i=1}^m N_i\\) é o tamanho da população. Como a verossimilhança pertence à família exponencial, temos que o modelo Gama\\((r,s)\\) é conjugado gerando a posteriori\n\\[\\lambda|\\mathbf{y}\\sim\\hbox{Gama}\\left(\\sum_{i=1}^{m}y_i+r,N+s\\right)\\equiv \\hbox{Gamma}(r_1,s_1).\\]\nConsidere agora um novo valor observado da localidade \\(i\\). Sua preditiva a posteriori é dada por\n\\[\\begin{align}\nf(y^*_i|\\boldsymbol{y})&=\\int_0^\\infty f(y^*_i|\\lambda)f(\\lambda|\\boldsymbol{y})d\\lambda\\\\\n&\\int_0^\\infty \\frac{e^{-\\lambda N_i}(\\lambda N_i)^{y_i^*}}{y_i^*!}\\frac{s_1^{r_1}}{\\Gamma(r_1)}\\lambda^{r_1-1}e^{-\\lambda s_1}d\\lambda\\\\\n&=\\frac{\\Gamma(r_1+y_i^*)}{y_i^*!\\Gamma(r_1)}\\left(\\frac{s_i}{N_i+s_i}\\right)^{r_1}\\left(1-\\frac{s_i}{N_i+s_i}\\right)^{y_i^*},\n\\end{align}\\] ou seja, \\[y_i^*|\\boldsymbol{y}\\sim\\text{Binomial Negativa}\\left(r_1,\\frac{s_1}{N_i+s_1}\\right),\\] cujo valor esperado é \\[E(y_i^*|\\boldsymbol{y})=\\frac{r_1}{s_1}N_i.\\] Observe que \\(y_1^*\\) e \\(y_j^*\\) possuem a mesma distribuição somente se \\(N_i=N_j\\).\n\n\n\n\nUnidade Federativa\nPopulação Estimada (1º de Julho de 2024)\n\n\n\n\nSão Paulo\n45.973.194\n\n\nMinas Gerais\n21.322.691\n\n\nRio de Janeiro\n17.219.679\n\n\nBahia\n14.850.513\n\n\nParaná\n11.824.665\n\n\nRio Grande do Sul\n11.229.915\n\n\nPernambuco\n9.539.029\n\n\nCeará\n9.233.656\n\n\nPará\n8.664.306\n\n\nSanta Catarina\n8.058.441\n\n\nGoiás\n7.350.483\n\n\nMaranhão\n7.010.960\n\n\nAmazonas\n4.281.209\n\n\nParaíba\n4.145.040\n\n\nEspírito Santo\n4.102.129\n\n\nMato Grosso\n3.836.399\n\n\nRio Grande do Norte\n3.446.071\n\n\nPiauí\n3.375.646\n\n\nAlagoas\n3.220.104\n\n\nDistrito Federal\n\n\n\nMato Grosso do Sul\n2.901.895\n\n\nSergipe\n2.291.077\n\n\nRondônia\n1.746.227\n\n\nTocantins\n1.577.342\n\n\nAcre\n880.631\n\n\nAmapá\n802.837\n\n\nRoraima\n716.793\n\n\n\n\n\nCrime de estupro de vulnerável no interior do Amazonas\nOs dados a seguir foram cedidos pelo Observatório de Violência de Gênero no Amazonas e compreendem os anos entre 2010 e 2012. A população em risco é o número de mulheres co menos de 14 anos.\n\n\n\nCidade\nVítimas\nPopulacao feminina\n\n\n\n\nAmatura\n3\n639\n\n\nAtalaia do Norte\n6\n905\n\n\nBarreirinha\n12\n1899\n\n\nBenjamin Constant\n2\n2036\n\n\nBoa Vista do Ramos\n6\n1060\n\n\nFonte Boa\n0\n1438\n\n\nJutai\n1\n1143\n\n\nMaues\n13\n3421\n\n\nNhamunda\n9\n1168\n\n\nParintins\n20\n6700\n\n\nSanto Antonio do Ica\n7\n1608\n\n\nSao Paulo de Olivenca\n5\n2033\n\n\nTabatinga\n8\n3095\n\n\nTonantins\n1\n1186\n\n\n\nAbaixo, organizamos os dados. A população é dividida por \\(10^5\\) para que a taxa seja interpretada como número de casos para cada 100.000 mulheres menores de 14 anos.\n\n# banco de dados\ncasos &lt;- c( 3, 6, 12, 2, 6, 0, 1, 13, 9, 20, 7, 5, 8, 1 )   \n\npop &lt;- c(639, 905, 1899, 2036, 1060, 1438, 1143, 3421, 1168, 6700, 1608, 2033, 3095, 1186)\npop &lt;- pop/10^5\n\nmunicipios &lt;- c( 'Amaturá', 'Ataláia do Norte', 'Barreirinha', 'Benjamin Constant','Boa Vista do Ramos', 'Fonte Boa', 'Jutaí', 'Maués', 'Nhamunda', 'Parintins', 'Sto Antônio do Iça', 'São Paulo de Olivença', 'Tabatinga','Tonantins')\n\nA veromissilhança é dada por \\[L(\\lambda)\\propto \\lambda^{93}e^{-0,28331\\lambda }.\\] Utilizando a priori \\(\\lambda\\sim\\hbox{Gama}(.5,.00001)\\), teremos a posteriori \\(\\lambda\\sim\\hbox{Gama}(93.5,0.28332)\\)\nVamos calcular o número de casos esperado segundo a preditiva a posteriori para cada município.\n\nr &lt;- .5\ns &lt;- .00001\n\nr1 &lt;- sum(casos) + r\ns1 &lt;- sum(pop) + s\n\nesperado &lt;- r1 * pop / s1\n\nO gráfico abaixo apresenta o valor da média da preditiva a posteriori contra o número de casos observados. Como esperado, os pares ordenados flutuam em torno da linha \\(y=x\\).\n\nplot(casos, esperado, xlab = 'Casos observados', ylab = 'Casos esperados')\nabline(0,1,lty = 2)\n\n\n\n\n\n\n\n\nMesmo que os pontos no gráfico acima estejam flutuando em torno da reta \\(y=x\\), é importante determinar se sua distância até a reta é razoável. Podemos construir intervalos de 95% (de predição) para \\(y^*_i\\) utilizando os quantis da preditiva a posteriori, ou seja, encontrando \\(q_1\\) e \\(q_2\\) tais que \\[\\begin{align}\nP(Y_i^*\\leq q_1|\\boldsymbol{y})&=0,025\\\\\nP(Y_i^*\\leq q_2|\\boldsymbol{y})&=0,975.\n\\end{align}\n\\]\nObserve ainda que \\[0,95\\approx P(q_1\\leq Y_i^*\\leq q_2|\\boldsymbol{y})=P\\left(\\frac{q_1}{N_i}\\leq \\frac{Y_i^*}{N_i}\\leq \\frac{q_2}{N_i}|\\boldsymbol{y}\\right),\\] o que implica que \\((q_1,q_2)/N_i\\) é um intervalo para taxa esperada. Abaixo construímos os intervalos de 95% (de predição) e colocamos o número de casos observados.\n\n# limites do intervalo\nlim_inf &lt;- qnbinom(.025, size = r1, prob = s1/(pop+s1))\n\nlim_sup &lt;- qnbinom(.975, size = r1, prob = s1/(pop+s1))\n\n# gráfico\nplot.new()\nplot.window( xlim = c(-500,1000), ylim=c(0,15))\nsegments(lim_inf/pop,1:14,lim_sup/pop,1:14, lwd = 2)\ntext(-500,1:14, municipios, adj =0 )\npoints(casos/pop, 1:14, pch = 22, cex =.9, bg = 'red')\n\n\n\n\n\n\n\n\nAlguns municípios, como Nanhunda, foram substimados, enquanto outros, como Fonte Boa, foram superestimados. Para estes 14 intervalos, é esperado que \\(14\\times 0,05=0,7\\) deles não cubram \\(y_i\\), o que não está ocorrendo. Portanto, considerar que todos os municípios possuem a mesma taxa pode ser um equívoco.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>O modelo Poisson</span>"
    ]
  },
  {
    "objectID": "poisson.html#exercícios",
    "href": "poisson.html#exercícios",
    "title": "7  O modelo Poisson",
    "section": "7.5 Exercícios",
    "text": "7.5 Exercícios\n\n7.5.1 Mortes por coice de cavalo\nLadislaus Bortkiewicz é o responsável pela popularização da distribuição Poisson. Em seu livro intitulado A Lei dos Pequenos Números, é apresentado um conjunto de dados no qual foi rastreado o número de mortes por coice de cavalo em 14 corpos do exército prussiano ao longo de 20 anos (de 1875 a 1894).\n\n\n\nMortes por corpo \\(\\times\\) ano\n0\n1\n2\n3\n\n\n\n\n109\n65\n22\n3\n1\n\n\n\nDetermine se a distribuição Poisson é adequada para este conjunto de dados. Em caso afirmativo, estime a taxa e dê um intervalo de credibilidade de 95%.\n\n\n7.5.2 Suicídios no Amazonas considerando capital e interior\nO Amazonas possui uma característica peculiar: aproximadamente 50% da população vive na capital. Vimos anteriormente que o número de suicídios, considerando os anos entre 2021 e 2023, podem ser modelados por uma Poisson. A tabela abaixo divide esses dados entre capital e interior.\n\nNúmero de suicídios divididos entre capital e interior\n\n\nAno\n2021\n2022\n2023\nTotal\n\n\n\n\nCapital\n133\n124\n138\n395\n\n\nInterior\n164\n173\n201\n538\n\n\n\nDetermine se há evidências de que essas taxas são diferentes.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>O modelo Poisson</span>"
    ]
  }
]